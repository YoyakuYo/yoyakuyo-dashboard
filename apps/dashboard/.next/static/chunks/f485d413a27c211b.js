(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,33527,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(22016),r=e.i(18566),o=e.i(14949),l=e.i(63611),n=e.i(48148);let i=t.default.memo(({isOpen:e,onClose:t,children:a})=>e?(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50",onClick:t,onMouseDown:e=>{e.target===e.currentTarget&&t()},children:(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full p-8 relative",onClick:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),onKeyDown:e=>{"Escape"===e.key&&e.stopPropagation()},children:[(0,s.jsx)("button",{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),t()},onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 text-2xl leading-none",children:"Ã—"}),a]})}):null);function d(){let e=(0,r.useRouter)(),{user:d,loading:c}=(0,l.useAuth)(),u=(0,n.useTranslations)(),[m,x]=(0,t.useState)(!1),[p,h]=(0,t.useState)(!1),[g,b]=(0,t.useState)(""),[f,y]=(0,t.useState)(""),[w,j]=(0,t.useState)(null),[N,v]=(0,t.useState)(!1),[C,S]=(0,t.useState)(""),[k,P]=(0,t.useState)(""),[A,D]=(0,t.useState)(""),[T,O]=(0,t.useState)(""),[F,E]=(0,t.useState)(null),[I,U]=(0,t.useState)(!1);(0,t.useEffect)(()=>{let e=()=>{x(!0)};return window.addEventListener("openLoginModal",e),()=>{window.removeEventListener("openLoginModal",e)}},[]),(0,t.useEffect)(()=>{!c&&d&&e.push("/shops")},[d,c,e]);let q=async s=>{s.preventDefault(),j(null),v(!0);try{let{error:s}=await (0,o.getSupabaseClient)().auth.signInWithPassword({email:g,password:f});if(s){j(s.message),v(!1);return}x(!1),e.push("/shops"),e.refresh()}catch(e){j(e.message||u("auth.unexpectedError")),v(!1)}},L=async s=>{s.preventDefault(),s.stopPropagation(),E(null),U(!0);try{if(!C||!k||!A){E(u("auth.fillRequiredFields")),U(!1);return}let s=(0,o.getSupabaseClient)();console.log("Creating user in Supabase Auth...");let{data:t,error:a}=await s.auth.signUp({email:k,password:A,options:{data:{name:C}}});if(a){console.error("Signup error:",a),E(a.message),U(!1);return}if(!t.user){console.error("No user returned from signup"),E("Failed to create user account"),U(!1);return}let r=t.user.id;console.log("User created in Auth:",r),console.log("Setting up user record and shop...");let l=await fetch("http://localhost:3000/auth/signup-owner",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:r,name:C,email:k,shop_name:T||null})});if(!l.ok){let e=await l.json().catch(()=>({error:"Failed to setup account"}));console.error("Setup API error:",e),E(e.error||u("auth.failedToSetupAccount")),U(!1);return}let n=await l.json();console.log("Account setup successful:",n);let i=t.session;if(!i){console.log("Checking current session...");let{data:e}=await s.auth.getSession();i=e.session}if(i)console.log("âœ… User already has active session");else{console.log("No session found, waiting for user to be ready..."),await new Promise(e=>setTimeout(e,1e3)),console.log("Attempting to sign in...");let{data:e,error:t}=await s.auth.signInWithPassword({email:k,password:A});if(t){console.error("Sign in error:",t),E("Account created successfully! Please sign in manually with your email and password. If you received a confirmation email, please confirm it first."),U(!1),h(!1),setTimeout(()=>{x(!0)},500);return}i=e.session,console.log("âœ… Signed in successfully")}await new Promise(e=>setTimeout(e,500)),h(!1),e.push("/shops"),e.refresh()}catch(e){console.error("Unexpected error during signup:",e),E(e instanceof Error?e.message:u("auth.unexpectedError")),U(!1)}},M=(0,t.useCallback)(()=>x(!1),[]),R=(0,t.useCallback)(()=>h(!1),[]);return(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,s.jsx)("section",{className:"py-16 md:py-24",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto px-4 text-center",children:[(0,s.jsx)("h1",{className:"text-5xl md:text-6xl font-bold text-gray-900 mb-6",children:u("home.title")}),(0,s.jsx)("p",{className:"text-xl md:text-2xl text-gray-600 mb-8",children:u("home.subtitle")}),(0,s.jsxs)("ul",{className:"space-y-3 mb-10 max-w-2xl mx-auto text-left",children:[(0,s.jsxs)("li",{className:"flex items-start gap-3",children:[(0,s.jsx)("span",{className:"text-2xl mt-1",children:"âœ“"}),(0,s.jsx)("span",{className:"text-lg text-gray-700",children:u("home.feature1")})]}),(0,s.jsxs)("li",{className:"flex items-start gap-3",children:[(0,s.jsx)("span",{className:"text-2xl mt-1",children:"âœ“"}),(0,s.jsx)("span",{className:"text-lg text-gray-700",children:u("home.feature2")})]}),(0,s.jsxs)("li",{className:"flex items-start gap-3",children:[(0,s.jsx)("span",{className:"text-2xl mt-1",children:"âœ“"}),(0,s.jsx)("span",{className:"text-lg text-gray-700",children:u("home.feature3")})]})]}),(0,s.jsxs)("div",{className:"flex gap-4 justify-center flex-wrap",children:[(0,s.jsx)(a.default,{href:"/browse",className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-8 rounded-lg shadow-md hover:shadow-lg transition-all duration-200",children:u("home.browseShops")}),(0,s.jsx)("button",{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),x(!0)},className:"bg-white hover:bg-gray-50 text-gray-700 font-semibold py-3 px-8 rounded-lg shadow-md hover:shadow-lg transition-all duration-200 border border-gray-300",children:u("home.ownerLogin")}),(0,s.jsx)("button",{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),h(!0)},className:"bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 px-8 rounded-lg shadow-md hover:shadow-lg transition-all duration-200",children:u("home.joinAsOwner")})]})]})}),(0,s.jsx)("section",{className:"py-16 border-t border-gray-200 bg-gray-50",children:(0,s.jsx)("div",{className:"max-w-6xl mx-auto px-4",children:(0,s.jsxs)("div",{className:"grid md:grid-cols-3 gap-8",children:[(0,s.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[(0,s.jsx)("div",{className:"text-4xl mb-4",children:"ðŸ”"}),(0,s.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:u("home.forCustomers")}),(0,s.jsx)("p",{className:"text-gray-600",children:u("home.forCustomersDesc")})]}),(0,s.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[(0,s.jsx)("div",{className:"text-4xl mb-4",children:"ðŸ‘”"}),(0,s.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:u("home.forOwners")}),(0,s.jsx)("p",{className:"text-gray-600",children:u("home.forOwnersDesc")})]}),(0,s.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100",children:[(0,s.jsx)("div",{className:"text-4xl mb-4",children:"ðŸ¤–"}),(0,s.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:u("home.aiAssistance")}),(0,s.jsx)("p",{className:"text-gray-600",children:u("home.aiAssistanceDesc")})]})]})})}),(0,s.jsxs)(i,{isOpen:m,onClose:M,children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:u("auth.signInToShop")}),w&&(0,s.jsx)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:w}),(0,s.jsxs)("form",{onSubmit:q,className:"space-y-5",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"login-email",className:"block text-sm font-medium text-gray-700 mb-2",children:u("common.email")}),(0,s.jsx)("input",{id:"login-email",type:"email",value:g,onChange:e=>b(e.target.value),required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition",placeholder:"your@email.com"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"login-password",className:"block text-sm font-medium text-gray-700 mb-2",children:u("auth.password")}),(0,s.jsx)("input",{id:"login-password",type:"password",value:f,onChange:e=>y(e.target.value),required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"})]}),(0,s.jsx)("button",{type:"submit",disabled:N,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:N?u("auth.signingIn"):u("auth.signIn")})]}),(0,s.jsxs)("p",{className:"mt-6 text-center text-sm text-gray-600",children:[u("auth.dontHaveAccount")," ",(0,s.jsx)("button",{onClick:()=>{x(!1),h(!0)},className:"text-blue-600 hover:text-blue-700 font-medium",children:u("home.joinAsOwner")})]})]}),(0,s.jsxs)(i,{isOpen:p,onClose:R,children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:u("auth.createOwnerAccount")}),F&&(0,s.jsx)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:F}),(0,s.jsxs)("form",{onSubmit:L,className:"space-y-4",noValidate:!0,children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{htmlFor:"signup-name",className:"block text-sm font-medium text-gray-700 mb-1",children:[u("auth.ownerName")," ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)("input",{id:"signup-name",type:"text",value:C,onChange:e=>S(e.target.value),required:!0,autoComplete:"name",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",placeholder:u("auth.ownerName")})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{htmlFor:"signup-email",className:"block text-sm font-medium text-gray-700 mb-1",children:[u("common.email")," ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)("input",{id:"signup-email",type:"email",value:k,onChange:e=>P(e.target.value),required:!0,autoComplete:"email",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",placeholder:"your@email.com"})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{htmlFor:"signup-password",className:"block text-sm font-medium text-gray-700 mb-1",children:[u("auth.password")," ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)("input",{id:"signup-password",type:"password",value:A,onChange:e=>D(e.target.value),required:!0,minLength:6,autoComplete:"new-password",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{htmlFor:"signup-shop-name",className:"block text-sm font-medium text-gray-700 mb-1",children:[u("myShop.shopName")," ",(0,s.jsxs)("span",{className:"text-gray-400 text-xs",children:["(",u("common.optional"),")"]})]}),(0,s.jsx)("input",{id:"signup-shop-name",type:"text",value:T,onChange:e=>O(e.target.value),autoComplete:"organization",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",placeholder:u("myShop.shopName")})]}),(0,s.jsx)("button",{type:"button",disabled:I,onClick:async e=>{e.preventDefault(),e.stopPropagation(),await L({preventDefault:()=>{},stopPropagation:()=>{}})},className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:I?u("auth.creatingAccount"):u("auth.signUp")})]}),(0,s.jsxs)("p",{className:"mt-6 text-center text-sm text-gray-600",children:[u("auth.alreadyHaveAccount")," ",(0,s.jsx)("button",{onClick:()=>{h(!1),x(!0)},className:"text-blue-600 hover:text-blue-700 font-medium",children:u("auth.signIn")})]})]})]})}i.displayName="Modal",e.s(["default",()=>d,"dynamic",0,"force-dynamic"])}]);