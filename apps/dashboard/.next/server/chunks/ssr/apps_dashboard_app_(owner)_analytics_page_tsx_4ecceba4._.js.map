{"version":3,"sources":["../../../../../../apps/dashboard/app/%28owner%29/analytics/page.tsx","../../../../../../apps/dashboard/app/components/AnalyticsCard.tsx","../../../../../../apps/dashboard/app/components/LineChart.tsx","../../../../../../apps/dashboard/app/components/BarChart.tsx"],"sourcesContent":["// apps/dashboard/app/(owner)/analytics/page.tsx\r\n// Analytics dashboard for shop owners\r\n\r\n\"use client\";\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useAuth } from '@/lib/useAuth';\r\nimport { useRouter } from 'next/navigation';\r\nimport { useTranslations } from 'next-intl';\r\nimport AnalyticsCard from '../../components/AnalyticsCard';\r\nimport LineChart from '../../components/LineChart';\r\nimport BarChart from '../../components/BarChart';\r\n\r\ninterface Shop {\r\n  id: string;\r\n  name: string;\r\n}\r\n\r\nexport default function AnalyticsPage() {\r\n  const { user, loading: authLoading } = useAuth();\r\n  const router = useRouter();\r\n  const t = useTranslations();\r\n  const apiUrl = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3000';\r\n\r\n  const [shop, setShop] = useState<Shop | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [dateRange, setDateRange] = useState<'7' | '30' | '90' | 'custom'>('30');\r\n  const [customStartDate, setCustomStartDate] = useState('');\r\n  const [customEndDate, setCustomEndDate] = useState('');\r\n\r\n  // Overview stats\r\n  const [overview, setOverview] = useState<any>(null);\r\n  const [bookingTrends, setBookingTrends] = useState<any[]>([]);\r\n  const [servicePopularity, setServicePopularity] = useState<any[]>([]);\r\n  const [staffPerformance, setStaffPerformance] = useState<any[]>([]);\r\n  const [customerAnalytics, setCustomerAnalytics] = useState<any>(null);\r\n  const [peakHours, setPeakHours] = useState<any[]>([]);\r\n\r\n  useEffect(() => {\r\n    if (!authLoading && !user) {\r\n      router.push('/');\r\n      return;\r\n    }\r\n\r\n    if (user) {\r\n      loadShop();\r\n    }\r\n  }, [user, authLoading, router]);\r\n\r\n  useEffect(() => {\r\n    if (shop) {\r\n      loadAnalytics();\r\n    }\r\n  }, [shop, dateRange, customStartDate, customEndDate]);\r\n\r\n  const loadShop = async () => {\r\n    try {\r\n      const res = await fetch(`${apiUrl}/shops?owner_user_id=${user?.id}`, {\r\n        headers: {\r\n          'x-user-id': user?.id || '',\r\n        },\r\n      });\r\n      if (res.ok) {\r\n        const shops = await res.json();\r\n        if (shops && shops.length > 0) {\r\n          setShop(shops[0]);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading shop:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const getDateRange = () => {\r\n    const endDate = new Date().toISOString();\r\n    let startDate: Date;\r\n\r\n    if (dateRange === 'custom' && customStartDate && customEndDate) {\r\n      return { startDate: customStartDate, endDate: customEndDate };\r\n    }\r\n\r\n    if (dateRange === '7') {\r\n      startDate = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000);\r\n    } else if (dateRange === '90') {\r\n      startDate = new Date(Date.now() - 90 * 24 * 60 * 60 * 1000);\r\n    } else {\r\n      // 30 days default\r\n      startDate = new Date(Date.now() - 30 * 24 * 60 * 60 * 1000);\r\n    }\r\n\r\n    return { startDate: startDate.toISOString(), endDate };\r\n  };\r\n\r\n  const loadAnalytics = async () => {\r\n    if (!shop) return;\r\n\r\n    const { startDate, endDate } = getDateRange();\r\n\r\n    try {\r\n      setLoading(true);\r\n\r\n      // Load all analytics in parallel\r\n      const [\r\n        overviewRes,\r\n        trendsRes,\r\n        servicesRes,\r\n        staffRes,\r\n        customersRes,\r\n        peakHoursRes,\r\n      ] = await Promise.all([\r\n        fetch(\r\n          `${apiUrl}/analytics/shop/${shop.id}/overview?start_date=${startDate}&end_date=${endDate}`,\r\n          {\r\n            headers: { 'x-user-id': user?.id || '' },\r\n          }\r\n        ),\r\n        fetch(\r\n          `${apiUrl}/analytics/shop/${shop.id}/bookings?start_date=${startDate}&end_date=${endDate}&group_by=day`,\r\n          {\r\n            headers: { 'x-user-id': user?.id || '' },\r\n          }\r\n        ),\r\n        fetch(\r\n          `${apiUrl}/analytics/shop/${shop.id}/services?start_date=${startDate}&end_date=${endDate}`,\r\n          {\r\n            headers: { 'x-user-id': user?.id || '' },\r\n          }\r\n        ),\r\n        fetch(\r\n          `${apiUrl}/analytics/shop/${shop.id}/staff?start_date=${startDate}&end_date=${endDate}`,\r\n          {\r\n            headers: { 'x-user-id': user?.id || '' },\r\n          }\r\n        ),\r\n        fetch(\r\n          `${apiUrl}/analytics/shop/${shop.id}/customers?start_date=${startDate}&end_date=${endDate}`,\r\n          {\r\n            headers: { 'x-user-id': user?.id || '' },\r\n          }\r\n        ),\r\n        fetch(\r\n          `${apiUrl}/analytics/shop/${shop.id}/peak-hours?start_date=${startDate}&end_date=${endDate}`,\r\n          {\r\n            headers: { 'x-user-id': user?.id || '' },\r\n          }\r\n        ),\r\n      ]);\r\n\r\n      if (overviewRes.ok) {\r\n        const data = await overviewRes.json();\r\n        setOverview(data);\r\n      }\r\n      if (trendsRes.ok) {\r\n        const data = await trendsRes.json();\r\n        setBookingTrends(data);\r\n      }\r\n      if (servicesRes.ok) {\r\n        const data = await servicesRes.json();\r\n        setServicePopularity(data);\r\n      }\r\n      if (staffRes.ok) {\r\n        const data = await staffRes.json();\r\n        setStaffPerformance(data);\r\n      }\r\n      if (customersRes.ok) {\r\n        const data = await customersRes.json();\r\n        setCustomerAnalytics(data);\r\n      }\r\n      if (peakHoursRes.ok) {\r\n        const data = await peakHoursRes.json();\r\n        setPeakHours(data);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading analytics:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  if (loading && !shop) {\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-screen\">\r\n        <p className=\"text-gray-500\">{t('common.loading')}</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!shop) {\r\n    return (\r\n      <div className=\"max-w-7xl mx-auto px-4 py-8\">\r\n        <p className=\"text-gray-500\">{t('myShop.noShop')}</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"max-w-7xl mx-auto px-4 py-8\">\r\n      <div className=\"mb-6\">\r\n        <h1 className=\"text-3xl font-bold text-gray-900 mb-2\">\r\n          {t('analytics.title')}\r\n        </h1>\r\n        <p className=\"text-gray-600\">{shop.name}</p>\r\n      </div>\r\n\r\n      {/* Date Range Selector */}\r\n      <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6\">\r\n        <div className=\"flex items-center gap-4 flex-wrap\">\r\n          <label className=\"text-sm font-medium text-gray-700\">\r\n            {t('analytics.dateRange')}:\r\n          </label>\r\n          <button\r\n            onClick={() => setDateRange('7')}\r\n            className={`px-4 py-2 rounded-md ${\r\n              dateRange === '7'\r\n                ? 'bg-blue-600 text-white'\r\n                : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\r\n            }`}\r\n          >\r\n            {t('analytics.last7Days')}\r\n          </button>\r\n          <button\r\n            onClick={() => setDateRange('30')}\r\n            className={`px-4 py-2 rounded-md ${\r\n              dateRange === '30'\r\n                ? 'bg-blue-600 text-white'\r\n                : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\r\n            }`}\r\n          >\r\n            {t('analytics.last30Days')}\r\n          </button>\r\n          <button\r\n            onClick={() => setDateRange('90')}\r\n            className={`px-4 py-2 rounded-md ${\r\n              dateRange === '90'\r\n                ? 'bg-blue-600 text-white'\r\n                : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\r\n            }`}\r\n          >\r\n            {t('analytics.last90Days')}\r\n          </button>\r\n          <button\r\n            onClick={() => setDateRange('custom')}\r\n            className={`px-4 py-2 rounded-md ${\r\n              dateRange === 'custom'\r\n                ? 'bg-blue-600 text-white'\r\n                : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\r\n            }`}\r\n          >\r\n            {t('analytics.custom')}\r\n          </button>\r\n          {dateRange === 'custom' && (\r\n            <div className=\"flex items-center gap-2\">\r\n              <input\r\n                type=\"date\"\r\n                value={customStartDate}\r\n                onChange={(e) => setCustomStartDate(e.target.value)}\r\n                className=\"px-3 py-2 border border-gray-300 rounded-md\"\r\n              />\r\n              <span>to</span>\r\n              <input\r\n                type=\"date\"\r\n                value={customEndDate}\r\n                onChange={(e) => setCustomEndDate(e.target.value)}\r\n                className=\"px-3 py-2 border border-gray-300 rounded-md\"\r\n              />\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Overview Cards */}\r\n      {overview && (\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6\">\r\n          <AnalyticsCard\r\n            title={t('analytics.bookings')}\r\n            value={overview.totalBookings}\r\n            subtitle={t('analytics.averagePerDay') + ': ' + overview.averageBookingsPerDay.toFixed(1)}\r\n          />\r\n          <AnalyticsCard\r\n            title={t('analytics.revenue')}\r\n            value={`¥${overview.totalRevenue.toLocaleString()}`}\r\n            subtitle={t('analytics.averagePerDay') + ': ¥' + overview.averageRevenuePerDay.toFixed(0)}\r\n          />\r\n          <AnalyticsCard\r\n            title={t('analytics.cancellationRate')}\r\n            value={`${overview.cancellationRate.toFixed(1)}%`}\r\n          />\r\n          <AnalyticsCard\r\n            title={t('analytics.completedBookings')}\r\n            value={overview.completedBookings}\r\n          />\r\n        </div>\r\n      )}\r\n\r\n      {/* Booking Trends Chart */}\r\n      {bookingTrends.length > 0 && (\r\n        <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6\">\r\n          <h2 className=\"text-xl font-bold text-gray-900 mb-4\">\r\n            {t('analytics.bookingTrends')}\r\n          </h2>\r\n          <LineChart\r\n            data={bookingTrends.map((t) => ({\r\n              x: t.date,\r\n              y: t.count,\r\n            }))}\r\n            height={300}\r\n            xLabel={t('analytics.date')}\r\n            yLabel={t('analytics.bookings')}\r\n          />\r\n        </div>\r\n      )}\r\n\r\n      {/* Service Popularity */}\r\n      {servicePopularity.length > 0 && (\r\n        <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6\">\r\n          <h2 className=\"text-xl font-bold text-gray-900 mb-4\">\r\n            {t('analytics.servicePopularity')}\r\n          </h2>\r\n          <BarChart\r\n            data={servicePopularity.slice(0, 10).map((s) => ({\r\n              label: s.serviceName,\r\n              value: s.bookingCount,\r\n            }))}\r\n            height={300}\r\n          />\r\n        </div>\r\n      )}\r\n\r\n      {/* Staff Performance */}\r\n      {staffPerformance.length > 0 && (\r\n        <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6\">\r\n          <h2 className=\"text-xl font-bold text-gray-900 mb-4\">\r\n            {t('analytics.staffPerformance')}\r\n          </h2>\r\n          <div className=\"overflow-x-auto\">\r\n            <table className=\"min-w-full divide-y divide-gray-200\">\r\n              <thead className=\"bg-gray-50\">\r\n                <tr>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase\">\r\n                    {t('myShop.staff')}\r\n                  </th>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase\">\r\n                    {t('analytics.bookings')}\r\n                  </th>\r\n                </tr>\r\n              </thead>\r\n              <tbody className=\"bg-white divide-y divide-gray-200\">\r\n                {staffPerformance.map((staff) => (\r\n                  <tr key={staff.staffId}>\r\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\">\r\n                      {staff.staffName}\r\n                    </td>\r\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\r\n                      {staff.bookingCount}\r\n                    </td>\r\n                  </tr>\r\n                ))}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Customer Analytics */}\r\n      {customerAnalytics && (\r\n        <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6\">\r\n          <h2 className=\"text-xl font-bold text-gray-900 mb-4\">\r\n            {t('analytics.customerAnalytics')}\r\n          </h2>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n            <AnalyticsCard\r\n              title={t('analytics.newCustomers')}\r\n              value={customerAnalytics.newCustomers}\r\n            />\r\n            <AnalyticsCard\r\n              title={t('analytics.returningCustomers')}\r\n              value={customerAnalytics.returningCustomers}\r\n            />\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Peak Hours */}\r\n      {peakHours.length > 0 && (\r\n        <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-6\">\r\n          <h2 className=\"text-xl font-bold text-gray-900 mb-4\">\r\n            {t('analytics.peakHours')}\r\n          </h2>\r\n          <BarChart\r\n            data={peakHours.map((h) => ({\r\n              label: `${h.hour}:00`,\r\n              value: h.bookingCount,\r\n            }))}\r\n            height={300}\r\n          />\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n","// apps/dashboard/app/components/AnalyticsCard.tsx\r\n// Reusable card component for displaying analytics metrics\r\n\r\n\"use client\";\r\nimport React from 'react';\r\n\r\ninterface AnalyticsCardProps {\r\n  title: string;\r\n  value: string | number;\r\n  change?: number;\r\n  changeLabel?: string;\r\n  icon?: React.ReactNode;\r\n  subtitle?: string;\r\n}\r\n\r\nexport default function AnalyticsCard({\r\n  title,\r\n  value,\r\n  change,\r\n  changeLabel,\r\n  icon,\r\n  subtitle,\r\n}: AnalyticsCardProps) {\r\n  const changeColor =\r\n    change !== undefined\r\n      ? change >= 0\r\n        ? 'text-green-600'\r\n        : 'text-red-600'\r\n      : 'text-gray-600';\r\n\r\n  return (\r\n    <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-6\">\r\n      <div className=\"flex items-center justify-between mb-2\">\r\n        <h3 className=\"text-sm font-medium text-gray-600\">{title}</h3>\r\n        {icon && <div className=\"text-gray-400\">{icon}</div>}\r\n      </div>\r\n      <div className=\"flex items-baseline gap-2\">\r\n        <p className=\"text-3xl font-bold text-gray-900\">{value}</p>\r\n        {change !== undefined && (\r\n          <span className={`text-sm font-medium ${changeColor}`}>\r\n            {change >= 0 ? '+' : ''}\r\n            {change}%\r\n          </span>\r\n        )}\r\n      </div>\r\n      {changeLabel && (\r\n        <p className=\"text-xs text-gray-500 mt-1\">{changeLabel}</p>\r\n      )}\r\n      {subtitle && <p className=\"text-sm text-gray-500 mt-2\">{subtitle}</p>}\r\n    </div>\r\n  );\r\n}\r\n\r\n","// apps/dashboard/app/components/LineChart.tsx\r\n// Simple line chart component using SVG\r\n\r\n\"use client\";\r\nimport React from 'react';\r\n\r\ninterface DataPoint {\r\n  x: string | number;\r\n  y: number;\r\n}\r\n\r\ninterface LineChartProps {\r\n  data: DataPoint[];\r\n  xLabel?: string;\r\n  yLabel?: string;\r\n  height?: number;\r\n  color?: string;\r\n}\r\n\r\nexport default function LineChart({\r\n  data,\r\n  xLabel,\r\n  yLabel,\r\n  height = 200,\r\n  color = '#3B82F6',\r\n}: LineChartProps) {\r\n  if (!data || data.length === 0) {\r\n    return (\r\n      <div\r\n        className=\"flex items-center justify-center text-gray-500\"\r\n        style={{ height }}\r\n      >\r\n        No data available\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const padding = 40;\r\n  const chartWidth = 600;\r\n  const chartHeight = height - padding * 2;\r\n\r\n  const maxY = Math.max(...data.map((d) => d.y), 1);\r\n  const minY = Math.min(...data.map((d) => d.y), 0);\r\n\r\n  const xScale = (index: number) =>\r\n    (index / (data.length - 1 || 1)) * (chartWidth - padding * 2) + padding;\r\n  const yScale = (value: number) =>\r\n    chartHeight -\r\n    ((value - minY) / (maxY - minY || 1)) * (chartHeight - padding) +\r\n    padding;\r\n\r\n  const points = data\r\n    .map((d, i) => `${xScale(i)},${yScale(d.y)}`)\r\n    .join(' ');\r\n\r\n  return (\r\n    <div className=\"w-full\">\r\n      <svg\r\n        viewBox={`0 0 ${chartWidth} ${height}`}\r\n        className=\"w-full h-full\"\r\n        preserveAspectRatio=\"xMidYMid meet\"\r\n      >\r\n        {/* Grid lines */}\r\n        {[0, 0.25, 0.5, 0.75, 1].map((ratio) => {\r\n          const y = padding + ratio * (chartHeight - padding);\r\n          return (\r\n            <line\r\n              key={ratio}\r\n              x1={padding}\r\n              y1={y}\r\n              x2={chartWidth - padding}\r\n              y2={y}\r\n              stroke=\"#E5E7EB\"\r\n              strokeWidth=\"1\"\r\n            />\r\n          );\r\n        })}\r\n\r\n        {/* Line */}\r\n        <polyline\r\n          points={points}\r\n          fill=\"none\"\r\n          stroke={color}\r\n          strokeWidth=\"2\"\r\n        />\r\n\r\n        {/* Data points */}\r\n        {data.map((d, i) => (\r\n          <circle\r\n            key={i}\r\n            cx={xScale(i)}\r\n            cy={yScale(d.y)}\r\n            r=\"4\"\r\n            fill={color}\r\n          />\r\n        ))}\r\n\r\n        {/* Labels */}\r\n        {xLabel && (\r\n          <text\r\n            x={chartWidth / 2}\r\n            y={height - 10}\r\n            textAnchor=\"middle\"\r\n            className=\"text-xs fill-gray-600\"\r\n          >\r\n            {xLabel}\r\n          </text>\r\n        )}\r\n        {yLabel && (\r\n          <text\r\n            x={15}\r\n            y={height / 2}\r\n            textAnchor=\"middle\"\r\n            className=\"text-xs fill-gray-600\"\r\n            transform={`rotate(-90, 15, ${height / 2})`}\r\n          >\r\n            {yLabel}\r\n          </text>\r\n        )}\r\n      </svg>\r\n    </div>\r\n  );\r\n}\r\n\r\n","// apps/dashboard/app/components/BarChart.tsx\r\n// Simple bar chart component using SVG\r\n\r\n\"use client\";\r\nimport React from 'react';\r\n\r\ninterface BarData {\r\n  label: string;\r\n  value: number;\r\n  color?: string;\r\n}\r\n\r\ninterface BarChartProps {\r\n  data: BarData[];\r\n  height?: number;\r\n  showValues?: boolean;\r\n}\r\n\r\nexport default function BarChart({\r\n  data,\r\n  height = 200,\r\n  showValues = true,\r\n}: BarChartProps) {\r\n  if (!data || data.length === 0) {\r\n    return (\r\n      <div\r\n        className=\"flex items-center justify-center text-gray-500\"\r\n        style={{ height }}\r\n      >\r\n        No data available\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const padding = 40;\r\n  const barWidth = Math.max(20, (600 - padding * 2) / data.length - 10);\r\n  const maxValue = Math.max(...data.map((d) => d.value), 1);\r\n\r\n  return (\r\n    <div className=\"w-full\">\r\n      <svg\r\n        viewBox={`0 0 600 ${height}`}\r\n        className=\"w-full h-full\"\r\n        preserveAspectRatio=\"xMidYMid meet\"\r\n      >\r\n        {/* Bars */}\r\n        {data.map((d, i) => {\r\n          const barHeight = (d.value / maxValue) * (height - padding * 2);\r\n          const x = padding + i * (barWidth + 10);\r\n          const y = height - padding - barHeight;\r\n          const color = d.color || '#3B82F6';\r\n\r\n          return (\r\n            <g key={i}>\r\n              <rect\r\n                x={x}\r\n                y={y}\r\n                width={barWidth}\r\n                height={barHeight}\r\n                fill={color}\r\n                rx=\"4\"\r\n              />\r\n              {showValues && d.value > 0 && (\r\n                <text\r\n                  x={x + barWidth / 2}\r\n                  y={y - 5}\r\n                  textAnchor=\"middle\"\r\n                  className=\"text-xs fill-gray-700 font-medium\"\r\n                >\r\n                  {d.value}\r\n                </text>\r\n              )}\r\n              <text\r\n                x={x + barWidth / 2}\r\n                y={height - 10}\r\n                textAnchor=\"middle\"\r\n                className=\"text-xs fill-gray-600\"\r\n                transform={`rotate(-45, ${x + barWidth / 2}, ${height - 10})`}\r\n              >\r\n                {d.label}\r\n              </text>\r\n            </g>\r\n          );\r\n        })}\r\n      </svg>\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":"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"}