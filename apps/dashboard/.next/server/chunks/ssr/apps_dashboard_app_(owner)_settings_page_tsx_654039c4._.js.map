{"version":3,"sources":["../../../../../../apps/dashboard/app/%28owner%29/settings/page.tsx"],"sourcesContent":["// apps/dashboard/app/(owner)/settings/page.tsx\r\n\"use client\";\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useAuth } from '@/lib/useAuth';\r\n\r\nconst LANGUAGE_OPTIONS = [\r\n  { code: 'en', name: 'English', flag: 'ðŸ‡ºðŸ‡¸' },\r\n  { code: 'ja', name: 'Japanese', flag: 'ðŸ‡¯ðŸ‡µ' },\r\n  { code: 'zh', name: 'Chinese', flag: 'ðŸ‡¨ðŸ‡³' },\r\n  { code: 'vi', name: 'Vietnamese', flag: 'ðŸ‡»ðŸ‡³' },\r\n  { code: 'pt', name: 'Portuguese', flag: 'ðŸ‡µðŸ‡¹' },\r\n  { code: 'fr', name: 'French', flag: 'ðŸ‡«ðŸ‡·' },\r\n  { code: 'ru', name: 'Russian', flag: 'ðŸ‡·ðŸ‡º' },\r\n  { code: 'es', name: 'Spanish', flag: 'ðŸ‡ªðŸ‡¸' },\r\n  { code: 'ko', name: 'Korean', flag: 'ðŸ‡°ðŸ‡·' },\r\n  { code: 'th', name: 'Thai', flag: 'ðŸ‡¹ðŸ‡­' },\r\n  { code: 'de', name: 'German', flag: 'ðŸ‡©ðŸ‡ª' },\r\n  { code: 'it', name: 'Italian', flag: 'ðŸ‡®ðŸ‡¹' },\r\n  { code: 'ar', name: 'Arabic', flag: 'ðŸ‡¸ðŸ‡¦' },\r\n  { code: 'hi', name: 'Hindi', flag: 'ðŸ‡®ðŸ‡³' },\r\n];\r\n\r\nexport default function SettingsPage() {\r\n  const { user } = useAuth();\r\n  const [preferredLanguage, setPreferredLanguage] = useState<string>('en');\r\n  const [loading, setLoading] = useState(true);\r\n  const [saving, setSaving] = useState(false);\r\n  const [message, setMessage] = useState<{ type: 'success' | 'error'; text: string } | null>(null);\r\n  const apiUrl = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3000';\r\n\r\n  useEffect(() => {\r\n    if (user?.id) {\r\n      loadPreferences();\r\n    }\r\n  }, [user]);\r\n\r\n  const loadPreferences = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const res = await fetch(`${apiUrl}/users/me`, {\r\n        headers: {\r\n          'x-user-id': user?.id || '',\r\n        },\r\n      });\r\n\r\n      if (res.ok) {\r\n        const data = await res.json();\r\n        setPreferredLanguage(data.preferredLanguage || 'en');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading preferences:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const savePreferences = async () => {\r\n    if (!user?.id) return;\r\n\r\n    try {\r\n      setSaving(true);\r\n      setMessage(null);\r\n\r\n      const res = await fetch(`${apiUrl}/users/me/preferences`, {\r\n        method: 'PATCH',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'x-user-id': user.id,\r\n        },\r\n        body: JSON.stringify({\r\n          preferredLanguage,\r\n        }),\r\n      });\r\n\r\n      const responseData = await res.json();\r\n\r\n      if (res.ok) {\r\n        setMessage({ type: 'success', text: 'Preferences saved successfully!' });\r\n        setTimeout(() => {\r\n          window.location.reload();\r\n        }, 1000);\r\n      } else {\r\n        // Show the actual error message from the API\r\n        const errorMessage = responseData.error || 'Failed to save preferences';\r\n        const errorDetails = responseData.details ? `: ${responseData.details}` : '';\r\n        console.error('API Error:', responseData);\r\n        setMessage({ type: 'error', text: `${errorMessage}${errorDetails}` });\r\n      }\r\n    } catch (error: any) {\r\n      console.error('Error saving preferences:', error);\r\n      setMessage({ type: 'error', text: `Failed to save preferences: ${error.message || 'Network error'}` });\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"p-8 flex items-center justify-center min-h-screen\">\r\n        <div className=\"text-center\">\r\n          <div className=\"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\r\n          <p className=\"mt-4 text-gray-600\">Loading settings...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"p-8 max-w-4xl mx-auto\">\r\n      <h1 className=\"text-3xl font-bold text-gray-900 mb-8\">Settings</h1>\r\n\r\n      <div className=\"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6\">\r\n        <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">Language Preferences</h2>\r\n        <p className=\"text-gray-600 mb-6\">\r\n          Choose your preferred language. All customer conversations will be translated to this language for you.\r\n        </p>\r\n\r\n        <div className=\"space-y-3\">\r\n          {LANGUAGE_OPTIONS.map((lang) => (\r\n            <label\r\n              key={lang.code}\r\n              className={`flex items-center gap-3 p-4 rounded-lg border-2 cursor-pointer transition-all ${\r\n                preferredLanguage === lang.code\r\n                  ? 'border-blue-500 bg-blue-50'\r\n                  : 'border-gray-200 hover:border-gray-300 hover:bg-gray-50'\r\n              }`}\r\n            >\r\n              <input\r\n                type=\"radio\"\r\n                name=\"preferredLanguage\"\r\n                value={lang.code}\r\n                checked={preferredLanguage === lang.code}\r\n                onChange={(e) => setPreferredLanguage(e.target.value)}\r\n                className=\"w-5 h-5 text-blue-600 focus:ring-blue-500\"\r\n              />\r\n              <span className=\"text-2xl\">{lang.flag}</span>\r\n              <span className=\"text-lg font-medium text-gray-900\">{lang.name}</span>\r\n            </label>\r\n          ))}\r\n        </div>\r\n\r\n        <button\r\n          onClick={savePreferences}\r\n          disabled={saving}\r\n          className=\"mt-6 px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n        >\r\n          {saving ? 'Saving...' : 'Save Preferences'}\r\n        </button>\r\n\r\n        {message && (\r\n          <div\r\n            className={`mt-4 p-4 rounded-lg ${\r\n              message.type === 'success'\r\n                ? 'bg-green-50 text-green-800 border border-green-200'\r\n                : 'bg-red-50 text-red-800 border border-red-200'\r\n            }`}\r\n          >\r\n            {message.text}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":"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"}