module.exports=[76199,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(38246),e=a.i(50944),f=a.i(15925);function g(a){if(!a)return"unknown";let b=a.toLowerCase();for(let[a,c]of Object.entries({chiyoda:"cities.chiyoda",chuo:"cities.chuo",minato:"cities.minato",shinjuku:"cities.shinjuku",bunkyo:"cities.bunkyo",taito:"cities.taito",sumida:"cities.sumida",koto:"cities.koto",shinagawa:"cities.shinagawa",meguro:"cities.meguro",ota:"cities.ota",setagaya:"cities.setagaya",shibuya:"cities.shibuya",nakano:"cities.nakano",suginami:"cities.suginami",toshima:"cities.toshima",kita:"cities.kita",arakawa:"cities.arakawa",itabashi:"cities.itabashi",nerima:"cities.nerima",adachi:"cities.adachi",katsushika:"cities.katsushika",edogawa:"cities.edogawa"}))if(b.includes(`${a}-ku`)||b.includes(`${a} ku`)||b.includes(`${a}åŒº`))return c;for(let b of[{pattern:/umeda|åŒ—åŒº/i,key:"cities.osaka_kita"},{pattern:/namba|é›£æ³¢/i,key:"cities.namba"},{pattern:/shinsaibashi|å¿ƒæ–Žæ©‹/i,key:"cities.shinsaibashi"},{pattern:/dotonbori|é“é “å €/i,key:"cities.dotonbori"},{pattern:/tennoji|å¤©çŽ‹å¯º/i,key:"cities.tennoji"},{pattern:/roppongi|å…­æœ¬æœ¨/i,key:"cities.roppongi"},{pattern:/ginza|éŠ€åº§/i,key:"cities.ginza"},{pattern:/akihabara|ç§‹è‘‰åŽŸ/i,key:"cities.akihabara"},{pattern:/harajuku|åŽŸå®¿/i,key:"cities.harajuku"},{pattern:/asakusa|æµ…è‰/i,key:"cities.asakusa"},{pattern:/omotesando|è¡¨å‚é“/i,key:"cities.omotesando"},{pattern:/ikebukuro|æ± è¢‹/i,key:"cities.ikebukuro"},{pattern:/ueno|ä¸Šé‡Ž/i,key:"cities.ueno"},{pattern:/yokohama|æ¨ªæµœ/i,key:"cities.yokohama"},{pattern:/osaka|å¤§é˜ª/i,key:"cities.osaka"},{pattern:/kyoto|äº¬éƒ½/i,key:"cities.kyoto"},{pattern:/sapporo|æœ­å¹Œ/i,key:"cities.sapporo"},{pattern:/fukuoka|ç¦å²¡/i,key:"cities.fukuoka"},{pattern:/nagoya|åå¤å±‹/i,key:"cities.nagoya"},{pattern:/kobe|ç¥žæˆ¸/i,key:"cities.kobe"},{pattern:/sendai|ä»™å°/i,key:"cities.sendai"},{pattern:/hiroshima|åºƒå³¶/i,key:"cities.hiroshima"}])if(b.pattern.test(a))return b.key;let c=a.match(/([^\s,]+)[-\s](ku|shi|city|åŒº|å¸‚)/i);if(c){let a=c[1].toLowerCase();return`cities.${a}`}let d=a.split(/[,\s]+/).filter(a=>a.length>2);return d.length>0?d[0].toLowerCase():"unknown"}function h(a,b){let c=a=>{try{let c=b(a);return c!==a?c:null}catch(a){return null}};if(a.startsWith("cities.")||a.startsWith("prefectures.")){let b=c(a);return b||(a.split(".").pop()||a).replace(/[-_]/g," ").replace(/\b\w/g,a=>a.toUpperCase())}let d=c(`cities.${a}`);return d||a.replace(/[-_]/g," ").replace(/\b\w/g,a=>a.toUpperCase()).trim()}let i=(a,b)=>{let c,d={barbershop:"categories.barbershop","beauty salon":"categories.beauty_salon",eyelash:"categories.eyelash","general salon":"categories.general_salon","hair salon":"categories.hair_salon","nail salon":"categories.nail_salon","spa & massage":"categories.spa_massage","spa and massage":"categories.spa_massage","dental clinic":"categories.dental_clinic","women's clinic":"categories.womens_clinic","hotels & ryokan":"categories.hotels_ryokan","restaurants & izakaya":"categories.restaurants_izakaya","spas, onsen & day-use bathhouses":"categories.spas_onsen_bathhouses","golf courses & practice ranges":"categories.golf_courses_ranges","private karaoke rooms":"categories.private_karaoke_rooms",unknown:"categories.unknown"}[c=a.toLowerCase().trim()]||`categories.${c.replace(/\s+/g,"_")}`;try{let c=b(d);return c!==d?c:a}catch(b){return a}};function j(){let a=(0,e.useSearchParams)(),j=(0,e.useRouter)(),k=(0,f.useTranslations)(),[l,m]=(0,c.useState)([]),[n,o]=(0,c.useState)([]),[p,q]=(0,c.useState)({}),[r,s]=(0,c.useState)(!0),[t,u]=(0,c.useState)(a.get("search")||""),[v,w]=(0,c.useState)(a.get("category_id")||null),[x,y]=(0,c.useState)(a.get("area")||null),[z,A]=(0,c.useState)(new Set),[B,C]=(0,c.useState)(new Set),D="http://localhost:3000",[E,F]=(0,c.useState)(t);(0,c.useEffect)(()=>{let a=setTimeout(()=>{F(t)},500);return()=>clearTimeout(a)},[t]),(0,c.useEffect)(()=>{(async()=>{try{let a=await fetch(`${D}/categories`);if(a.ok){let b=a.headers.get("content-type");if(b&&b.includes("application/json")){let b=await a.json();o(Array.isArray(b)?b:[])}}}catch(a){a?.message?.includes("Failed to fetch")||a?.message?.includes("ERR_CONNECTION_REFUSED")||console.error("Error fetching categories:",a),o([])}})()},[D]),(0,c.useEffect)(()=>{(async()=>{try{let a=await fetch(`${D}/categories/stats`);if(a.ok){let b=a.headers.get("content-type");if(b&&b.includes("application/json")){let b=await a.json();b&&"object"==typeof b&&!Array.isArray(b)&&q(b)}}}catch(a){a?.message?.includes("Failed to fetch")||a?.message?.includes("ERR_CONNECTION_REFUSED")||console.error("Error fetching category stats:",a),q({})}})()},[D]);let G=(0,c.useCallback)(async()=>{try{s(!0);let a=new URLSearchParams;E.trim()&&a.set("search",E.trim()),v&&"all"!==v&&a.set("category_id",v);let b=await fetch(`${D}/shops${a.toString()?`?${a.toString()}`:""}`);if(b.ok){let a=b.headers.get("content-type");if(a&&a.includes("application/json")){let a=await b.json(),c=Array.isArray(a)?a.filter(a=>!a.claim_status||"hidden"!==a.claim_status):[];m(c)}}}catch(a){a?.message?.includes("Failed to fetch")||a?.message?.includes("ERR_CONNECTION_REFUSED")||console.error("Error fetching shops:",a),m([])}finally{s(!1)}},[D,E,v]);(0,c.useEffect)(()=>{G()},[G]),(0,c.useEffect)(()=>{let a=new URLSearchParams;E&&a.set("search",E),v&&"all"!==v&&a.set("category_id",v),x&&a.set("area",x);let b=`/browse${a.toString()?`?${a.toString()}`:""}`;j.replace(b,{scroll:!1})},[E,v,x,j]);let H=(0,c.useMemo)(()=>{let a=new Map;(x?l.filter(a=>{let b=g(a.address);return h(b,k)===x||b===x}):l).forEach(b=>{let c=b.category_id||"unknown";b.categories?.name;let d=g(b.address);a.has(c)||a.set(c,new Map);let e=a.get(c);e.has(d)||e.set(d,[]),e.get(d).push(b)});let b=[];return a.forEach((a,c)=>{let d=Array.from(a.values())[0]?.[0],e=d?.categories?.name||"Unknown",f=Array.from(a.entries()).map(([a,b])=>({areaName:h(a,k),areaKey:a,shops:b,count:b.length})).sort((a,b)=>b.count-a.count),g=f.reduce((a,b)=>a+b.count,0);b.push({categoryId:c,categoryName:e,areas:f,totalShops:g})}),b.sort((a,b)=>b.totalShops-a.totalShops),b},[l,x]);(0,c.useEffect)(()=>{let a=new Set;H.forEach(b=>{b.totalShops>0&&a.add(b.categoryId)}),A(a)},[H]);let I=a=>{w(a),y(null)},J=()=>{y(null)},K=(0,c.useMemo)(()=>x?l.filter(a=>{let b=g(a.address);return h(b,k)===x||b===x}):l,[l,x,k]);return(0,b.jsxs)("div",{className:"flex flex-col lg:flex-row gap-8",children:[(0,b.jsx)("aside",{className:"w-full lg:w-64 flex-shrink-0",children:(0,b.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 p-6 sticky top-24",children:[(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:k("shops.search")}),(0,b.jsx)("input",{type:"text",value:t,onChange:a=>u(a.target.value),placeholder:k("shops.searchPlaceholder"),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"})]}),x&&(0,b.jsx)("div",{className:"mb-6 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-600 mb-1",children:k("shops.filteredByArea")}),(0,b.jsx)("p",{className:"text-sm font-semibold text-blue-700",children:x})]}),(0,b.jsx)("button",{onClick:J,className:"text-blue-600 hover:text-blue-800 text-sm font-medium",title:k("shops.clearAreaFilter"),children:"âœ•"})]})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:k("shops.categories")}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("button",{onClick:()=>I(null),className:`w-full text-left px-3 py-2 rounded-lg transition-colors ${!v||"all"===v?"bg-blue-100 text-blue-700 font-medium":"text-gray-700 hover:bg-gray-100"}`,children:[k("categories.all")," (",p.all||0,")"]}),n.map(a=>(0,b.jsxs)("button",{onClick:()=>I(a.id),className:`w-full text-left px-3 py-2 rounded-lg transition-colors ${v===a.id?"bg-blue-100 text-blue-700 font-medium":"text-gray-700 hover:bg-gray-100"}`,children:[i(a.name,k)," (",p[a.id]||0,")"]},a.id))]})]})]})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:k("shops.shops")}),(0,b.jsx)("p",{className:"text-gray-600",children:r?k("shops.loading"):k("shops.shopsFound",{count:K.length})})]}),r?(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),(0,b.jsx)("p",{className:"mt-4 text-gray-600",children:k("shops.loading")})]}):x?0===K.length?(0,b.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 p-12 text-center",children:[(0,b.jsx)("div",{className:"text-6xl mb-4",children:"ðŸª"}),(0,b.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:k("shops.noShops")}),(0,b.jsxs)("p",{className:"text-gray-600 mb-4",children:[k("shops.noShops")," ",k("shops.inAreas",{count:1})," ",x]}),(0,b.jsx)("button",{onClick:J,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:k("shops.clearAreaFilter")})]}):(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:K.map(a=>(0,b.jsxs)(d.default,{href:`/shops/${a.id}`,className:"bg-white rounded-xl border border-gray-200 overflow-hidden hover:shadow-lg transition-shadow",children:[a.image_url&&(0,b.jsx)("div",{className:"w-full h-48 overflow-hidden bg-gray-100",children:(0,b.jsx)("img",{src:a.image_url,alt:a.name,className:"w-full h-full object-cover"})}),(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsxs)("div",{className:"mb-2",children:[(0,b.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:a.name}),a.categories&&(0,b.jsx)("span",{className:"inline-block px-2 py-1 bg-blue-100 text-blue-700 text-xs font-medium rounded",children:i(a.categories.name,k)})]}),a.description&&(0,b.jsx)("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:((a,b=120)=>a?a.length<=b?a:a.substring(0,b)+"...":"")(a.description,100)}),(0,b.jsx)("p",{className:"text-gray-500 text-sm mb-4",children:a.address}),(0,b.jsx)("div",{className:"mt-4",children:(0,b.jsxs)("span",{className:"inline-block px-3 py-1 bg-blue-600 text-white text-sm font-medium rounded-lg",children:[k("shops.viewDetails")," â†’"]})})]})]},a.id))}):0===H.length?(0,b.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 p-12 text-center",children:[(0,b.jsx)("div",{className:"text-6xl mb-4",children:"ðŸª"}),(0,b.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:k("shops.noShops")}),(0,b.jsx)("p",{className:"text-gray-600",children:t||v?k("shops.tryAdjusting"):k("shops.notAvailable")})]}):(0,b.jsx)("div",{className:"space-y-8",children:H.map(a=>{let c=z.has(a.categoryId),d=a.areas.length<=10;return(0,b.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[(0,b.jsx)("button",{onClick:()=>{var b;let c;return b=a.categoryId,void((c=new Set(z)).has(b)?c.delete(b):c.add(b),A(c))},className:"w-full px-6 py-4 bg-gradient-to-r from-blue-50 to-indigo-50 hover:from-blue-100 hover:to-indigo-100 transition-colors flex items-center justify-between",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("span",{className:"text-2xl",children:c?"â–¼":"â–¶"}),(0,b.jsxs)("div",{className:"text-left",children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:i(a.categoryName,k)}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:k("shops.shopsInAreas",{shops:a.totalShops,areas:a.areas.length})})]})]})}),c&&(0,b.jsxs)("div",{className:"p-6 space-y-4",children:[(d||B.has(a.categoryId)?a.areas:a.areas.slice(0,10)).map(a=>(0,b.jsx)("div",{className:"border-l-4 border-blue-500 pl-4",children:(0,b.jsx)("button",{onClick:()=>{y(a.areaName)},className:"w-full text-left group hover:bg-blue-50 p-3 rounded-lg transition-colors",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 group-hover:text-blue-700",children:a.areaName}),(0,b.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[a.count," ",1!==a.count?k("shops.shops"):k("shops.shop")]})]}),(0,b.jsx)("span",{className:"text-blue-600 opacity-0 group-hover:opacity-100 transition-opacity",children:"View â†’"})]})})},a.areaName)),!d&&(0,b.jsx)("button",{onClick:()=>{let b=new Set(B);b.has(a.categoryId)?b.delete(a.categoryId):b.add(a.categoryId),C(b)},className:"w-full text-center py-2 text-blue-600 hover:text-blue-800 font-medium text-sm",children:B.has(a.categoryId)?k("shops.showLess",{hidden:a.areas.length-10}):k("shops.seeAllAreas",{count:a.areas.length})})]})]},a.categoryId)})})]})]})}function k(){let a=(0,f.useTranslations)();return(0,b.jsx)(c.Suspense,{fallback:(0,b.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),(0,b.jsx)("p",{className:"mt-4 text-gray-600",children:a("common.loading")})]})}),children:(0,b.jsx)(j,{})})}a.s(["default",()=>k])}];

//# sourceMappingURL=apps_dashboard_app_browse_page_tsx_8441860e._.js.map