{"version":3,"sources":["../../../../../../apps/dashboard/app/public/page.tsx"],"sourcesContent":["// apps/dashboard/app/public/page.tsx\r\n// Public home page with authentication modals\r\n\r\n\"use client\";\r\n\r\nimport React, { useState, useEffect, useCallback } from 'react';\r\nimport Link from 'next/link';\r\nimport { useRouter } from 'next/navigation';\r\nimport { getSupabaseClient } from '@/lib/supabaseClient';\r\nimport { AuthError } from '@supabase/supabase-js';\r\nimport { useAuth } from '@/lib/useAuth';\r\nimport { useTranslations } from 'next-intl';\r\n\r\nexport const dynamic = 'force-dynamic';\r\n\r\n// Modal component - defined outside to prevent recreation on every render\r\nconst Modal = React.memo(({ isOpen, onClose, children }: { isOpen: boolean; onClose: () => void; children: React.ReactNode }) => {\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div \r\n      className=\"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50\" \r\n      onClick={onClose}\r\n      onMouseDown={(e) => {\r\n        // Only close if clicking the backdrop, not the modal content\r\n        if (e.target === e.currentTarget) {\r\n          onClose();\r\n        }\r\n      }}\r\n    >\r\n      <div \r\n        className=\"bg-white rounded-xl shadow-2xl max-w-md w-full p-8 relative\" \r\n        onClick={(e) => e.stopPropagation()}\r\n        onMouseDown={(e) => e.stopPropagation()}\r\n        onKeyDown={(e) => {\r\n          // Prevent ESC key from bubbling up\r\n          if (e.key === 'Escape') {\r\n            e.stopPropagation();\r\n          }\r\n        }}\r\n      >\r\n        <button\r\n          type=\"button\"\r\n          onClick={(e) => {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            onClose();\r\n          }}\r\n          onMouseDown={(e) => {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n          }}\r\n          className=\"absolute top-4 right-4 text-gray-400 hover:text-gray-600 text-2xl leading-none\"\r\n        >\r\n          √ó\r\n        </button>\r\n        {children}\r\n      </div>\r\n    </div>\r\n  );\r\n});\r\n\r\nModal.displayName = 'Modal';\r\n\r\nexport default function PublicHomePage() {\r\n  const router = useRouter();\r\n  const { user, loading: authLoading } = useAuth();\r\n  const t = useTranslations();\r\n  const [showLoginModal, setShowLoginModal] = useState(false);\r\n  const [showSignupModal, setShowSignupModal] = useState(false);\r\n  \r\n  // Login form state\r\n  const [loginEmail, setLoginEmail] = useState('');\r\n  const [loginPassword, setLoginPassword] = useState('');\r\n  const [loginError, setLoginError] = useState<string | null>(null);\r\n  const [loginLoading, setLoginLoading] = useState(false);\r\n  \r\n  // Signup form state\r\n  const [signupName, setSignupName] = useState('');\r\n  const [signupEmail, setSignupEmail] = useState('');\r\n  const [signupPassword, setSignupPassword] = useState('');\r\n  const [signupShopName, setSignupShopName] = useState('');\r\n  const [signupError, setSignupError] = useState<string | null>(null);\r\n  const [signupLoading, setSignupLoading] = useState(false);\r\n\r\n  useEffect(() => {\r\n    // Listen for modal open events from navbar\r\n    const handleOpenLoginModal = () => {\r\n      setShowLoginModal(true);\r\n    };\r\n    if (typeof window !== 'undefined') {\r\n      window.addEventListener('openLoginModal', handleOpenLoginModal);\r\n    }\r\n    return () => {\r\n      if (typeof window !== 'undefined') {\r\n        window.removeEventListener('openLoginModal', handleOpenLoginModal);\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  // Redirect if already authenticated\r\n  useEffect(() => {\r\n    if (!authLoading && user) {\r\n      router.push('/shops');\r\n    }\r\n  }, [user, authLoading, router]);\r\n\r\n  const handleLoginSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setLoginError(null);\r\n    setLoginLoading(true);\r\n\r\n    try {\r\n      const { error: signInError } = await getSupabaseClient().auth.signInWithPassword({\r\n        email: loginEmail,\r\n        password: loginPassword,\r\n      });\r\n\r\n      if (signInError) {\r\n        setLoginError(signInError.message);\r\n        setLoginLoading(false);\r\n        return;\r\n      }\r\n\r\n      // Success - modal will close and user will be redirected\r\n      setShowLoginModal(false);\r\n      router.push('/shops');\r\n      router.refresh();\r\n    } catch (err) {\r\n      const authError = err as AuthError;\r\n      setLoginError(authError.message || t('auth.unexpectedError'));\r\n      setLoginLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleSignupSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    \r\n    setSignupError(null);\r\n    setSignupLoading(true);\r\n\r\n    try {\r\n      // Validate required fields\r\n      if (!signupName || !signupEmail || !signupPassword) {\r\n        setSignupError(t('auth.fillRequiredFields'));\r\n        setSignupLoading(false);\r\n        return;\r\n      }\r\n\r\n      const supabase = getSupabaseClient();\r\n      const apiUrl = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3000';\r\n\r\n      // Step 1: Create user in Supabase Auth\r\n      console.log('Creating user in Supabase Auth...');\r\n      const { data: authData, error: signUpError } = await supabase.auth.signUp({\r\n        email: signupEmail,\r\n        password: signupPassword,\r\n        options: {\r\n          data: {\r\n            name: signupName,\r\n          },\r\n        },\r\n      });\r\n\r\n      if (signUpError) {\r\n        console.error('Signup error:', signUpError);\r\n        setSignupError(signUpError.message);\r\n        setSignupLoading(false);\r\n        return;\r\n      }\r\n\r\n      if (!authData.user) {\r\n        console.error('No user returned from signup');\r\n        setSignupError('Failed to create user account');\r\n        setSignupLoading(false);\r\n        return;\r\n      }\r\n\r\n      const userId = authData.user.id;\r\n      console.log('User created in Auth:', userId);\r\n\r\n      // Step 2: Create user record in public.users and shop via backend API\r\n      console.log('Setting up user record and shop...');\r\n      const setupRes = await fetch(`${apiUrl}/auth/signup-owner`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          user_id: userId,\r\n          name: signupName,\r\n          email: signupEmail,\r\n          shop_name: signupShopName || null,\r\n        }),\r\n      });\r\n\r\n      if (!setupRes.ok) {\r\n        const errorData = await setupRes.json().catch(() => ({ error: 'Failed to setup account' }));\r\n        console.error('Setup API error:', errorData);\r\n        setSignupError(errorData.error || t('auth.failedToSetupAccount'));\r\n        setSignupLoading(false);\r\n        return;\r\n      }\r\n\r\n      const setupData = await setupRes.json();\r\n      console.log('Account setup successful:', setupData);\r\n\r\n      // Step 3: Check if user is signed in\r\n      // signUp() may return a session if email confirmation is disabled\r\n      let session = authData.session;\r\n      \r\n      if (!session) {\r\n        // Check current session\r\n        console.log('Checking current session...');\r\n        const { data: sessionData } = await supabase.auth.getSession();\r\n        session = sessionData.session;\r\n      }\r\n      \r\n      if (!session) {\r\n        // If no session, wait a moment for user to be ready, then try to sign in\r\n        console.log('No session found, waiting for user to be ready...');\r\n        await new Promise(resolve => setTimeout(resolve, 1000));\r\n        \r\n        console.log('Attempting to sign in...');\r\n        const { data: signInData, error: signInError } = await supabase.auth.signInWithPassword({\r\n          email: signupEmail,\r\n          password: signupPassword,\r\n        });\r\n\r\n        if (signInError) {\r\n          console.error('Sign in error:', signInError);\r\n          // Account was created successfully, but sign-in failed\r\n          // This might be due to email confirmation requirement or timing\r\n          // Show helpful message and let user sign in manually\r\n          setSignupError(`Account created successfully! Please sign in manually with your email and password. If you received a confirmation email, please confirm it first.`);\r\n          setSignupLoading(false);\r\n          setShowSignupModal(false);\r\n          // Show login modal instead\r\n          setTimeout(() => {\r\n            setShowLoginModal(true);\r\n          }, 500);\r\n          return;\r\n        }\r\n        \r\n        session = signInData.session;\r\n        console.log('‚úÖ Signed in successfully');\r\n      } else {\r\n        console.log('‚úÖ User already has active session');\r\n      }\r\n\r\n      // Success - wait a moment for auth state to update, then close modal and redirect\r\n      \r\n      // Small delay to ensure auth state updates\r\n      await new Promise(resolve => setTimeout(resolve, 500));\r\n      \r\n      // Close modal only after successful setup\r\n      setShowSignupModal(false);\r\n      \r\n      // Redirect to my-shop\r\n      router.push('/shops');\r\n      router.refresh();\r\n    } catch (err) {\r\n      console.error('Unexpected error during signup:', err);\r\n      const errorMessage = err instanceof Error ? err.message : t('auth.unexpectedError');\r\n      setSignupError(errorMessage);\r\n      setSignupLoading(false);\r\n    }\r\n  };\r\n\r\n  // Stable callbacks for modal close handlers\r\n  const handleCloseLoginModal = useCallback(() => setShowLoginModal(false), []);\r\n  const handleCloseSignupModal = useCallback(() => setShowSignupModal(false), []);\r\n\r\n  return (\r\n    <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\r\n      {/* Hero Section */}\r\n      <section className=\"py-16 md:py-24\">\r\n        <div className=\"max-w-4xl mx-auto px-4 text-center\">\r\n          <h1 className=\"text-5xl md:text-6xl font-bold text-gray-900 mb-6\">\r\n            {t('home.title')}\r\n          </h1>\r\n          <p className=\"text-xl md:text-2xl text-gray-600 mb-8\">\r\n            {t('home.subtitle')}\r\n          </p>\r\n          <ul className=\"space-y-3 mb-10 max-w-2xl mx-auto text-left\">\r\n            <li className=\"flex items-start gap-3\">\r\n              <span className=\"text-2xl mt-1\">‚úì</span>\r\n              <span className=\"text-lg text-gray-700\">\r\n                {t('home.feature1')}\r\n              </span>\r\n            </li>\r\n            <li className=\"flex items-start gap-3\">\r\n              <span className=\"text-2xl mt-1\">‚úì</span>\r\n              <span className=\"text-lg text-gray-700\">\r\n                {t('home.feature2')}\r\n              </span>\r\n            </li>\r\n            <li className=\"flex items-start gap-3\">\r\n              <span className=\"text-2xl mt-1\">‚úì</span>\r\n              <span className=\"text-lg text-gray-700\">\r\n                {t('home.feature3')}\r\n              </span>\r\n            </li>\r\n          </ul>\r\n          <div className=\"flex gap-4 justify-center flex-wrap\">\r\n            <Link\r\n              href=\"/browse\"\r\n              className=\"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-8 rounded-lg shadow-md hover:shadow-lg transition-all duration-200\"\r\n            >\r\n              {t('home.browseShops')}\r\n            </Link>\r\n            <button\r\n              type=\"button\"\r\n              onClick={(e) => {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                setShowLoginModal(true);\r\n              }}\r\n              className=\"bg-white hover:bg-gray-50 text-gray-700 font-semibold py-3 px-8 rounded-lg shadow-md hover:shadow-lg transition-all duration-200 border border-gray-300\"\r\n            >\r\n              {t('home.ownerLogin')}\r\n            </button>\r\n            <button\r\n              type=\"button\"\r\n              onClick={(e) => {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                setShowSignupModal(true);\r\n              }}\r\n              className=\"bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 px-8 rounded-lg shadow-md hover:shadow-lg transition-all duration-200\"\r\n            >\r\n              {t('home.joinAsOwner')}\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </section>\r\n\r\n      {/* Features Section */}\r\n      <section className=\"py-16 border-t border-gray-200 bg-gray-50\">\r\n        <div className=\"max-w-6xl mx-auto px-4\">\r\n          <div className=\"grid md:grid-cols-3 gap-8\">\r\n            <div className=\"bg-white rounded-xl p-6 shadow-sm border border-gray-100\">\r\n              <div className=\"text-4xl mb-4\">üîç</div>\r\n              <h3 className=\"text-xl font-bold text-gray-900 mb-2\">\r\n                {t('home.forCustomers')}\r\n              </h3>\r\n              <p className=\"text-gray-600\">\r\n                {t('home.forCustomersDesc')}\r\n              </p>\r\n            </div>\r\n            <div className=\"bg-white rounded-xl p-6 shadow-sm border border-gray-100\">\r\n              <div className=\"text-4xl mb-4\">üëî</div>\r\n              <h3 className=\"text-xl font-bold text-gray-900 mb-2\">\r\n                {t('home.forOwners')}\r\n              </h3>\r\n              <p className=\"text-gray-600\">\r\n                {t('home.forOwnersDesc')}\r\n              </p>\r\n            </div>\r\n            <div className=\"bg-white rounded-xl p-6 shadow-sm border border-gray-100\">\r\n              <div className=\"text-4xl mb-4\">ü§ñ</div>\r\n              <h3 className=\"text-xl font-bold text-gray-900 mb-2\">\r\n                {t('home.aiAssistance')}\r\n              </h3>\r\n              <p className=\"text-gray-600\">\r\n                {t('home.aiAssistanceDesc')}\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </section>\r\n\r\n      {/* Login Modal */}\r\n      <Modal isOpen={showLoginModal} onClose={handleCloseLoginModal}>\r\n        <h2 className=\"text-2xl font-bold text-gray-900 mb-6\">\r\n          {t('auth.signInToShop')}\r\n        </h2>\r\n\r\n        {loginError && (\r\n          <div className=\"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm\">\r\n            {loginError}\r\n          </div>\r\n        )}\r\n\r\n        <form onSubmit={handleLoginSubmit} className=\"space-y-5\">\r\n          <div>\r\n            <label htmlFor=\"login-email\" className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n              {t('common.email')}\r\n            </label>\r\n            <input\r\n              id=\"login-email\"\r\n              type=\"email\"\r\n              value={loginEmail}\r\n              onChange={(e) => setLoginEmail(e.target.value)}\r\n              required\r\n              className=\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition\"\r\n              placeholder=\"your@email.com\"\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label htmlFor=\"login-password\" className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n              {t('auth.password')}\r\n            </label>\r\n            <input\r\n              id=\"login-password\"\r\n              type=\"password\"\r\n              value={loginPassword}\r\n              onChange={(e) => setLoginPassword(e.target.value)}\r\n              required\r\n              className=\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition\"\r\n              placeholder=\"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢\"\r\n            />\r\n          </div>\r\n\r\n          <button\r\n            type=\"submit\"\r\n            disabled={loginLoading}\r\n            className=\"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n          >\r\n            {loginLoading ? t('auth.signingIn') : t('auth.signIn')}\r\n          </button>\r\n        </form>\r\n\r\n        <p className=\"mt-6 text-center text-sm text-gray-600\">\r\n          {t('auth.dontHaveAccount')}{' '}\r\n          <button\r\n            onClick={() => {\r\n              setShowLoginModal(false);\r\n              setShowSignupModal(true);\r\n            }}\r\n            className=\"text-blue-600 hover:text-blue-700 font-medium\"\r\n          >\r\n            {t('home.joinAsOwner')}\r\n          </button>\r\n        </p>\r\n      </Modal>\r\n\r\n      {/* Signup Modal */}\r\n      <Modal isOpen={showSignupModal} onClose={handleCloseSignupModal}>\r\n        <h2 className=\"text-2xl font-bold text-gray-900 mb-6\">\r\n          {t('auth.createOwnerAccount')}\r\n        </h2>\r\n\r\n        {signupError && (\r\n          <div className=\"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm\">\r\n            {signupError}\r\n          </div>\r\n        )}\r\n\r\n        <form \r\n          onSubmit={handleSignupSubmit} \r\n          className=\"space-y-4\"\r\n          noValidate\r\n        >\r\n          <div>\r\n            <label htmlFor=\"signup-name\" className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n              {t('auth.ownerName')} <span className=\"text-red-500\">*</span>\r\n            </label>\r\n            <input\r\n              id=\"signup-name\"\r\n              type=\"text\"\r\n              value={signupName}\r\n              onChange={(e) => setSignupName(e.target.value)}\r\n              required\r\n              autoComplete=\"name\"\r\n              className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none\"\r\n              placeholder={t('auth.ownerName')}\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label htmlFor=\"signup-email\" className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n              {t('common.email')} <span className=\"text-red-500\">*</span>\r\n            </label>\r\n            <input\r\n              id=\"signup-email\"\r\n              type=\"email\"\r\n              value={signupEmail}\r\n              onChange={(e) => setSignupEmail(e.target.value)}\r\n              required\r\n              autoComplete=\"email\"\r\n              className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none\"\r\n              placeholder=\"your@email.com\"\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label htmlFor=\"signup-password\" className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n              {t('auth.password')} <span className=\"text-red-500\">*</span>\r\n            </label>\r\n            <input\r\n              id=\"signup-password\"\r\n              type=\"password\"\r\n              value={signupPassword}\r\n              onChange={(e) => setSignupPassword(e.target.value)}\r\n              required\r\n              minLength={6}\r\n              autoComplete=\"new-password\"\r\n              className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none\"\r\n              placeholder=\"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢\"\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label htmlFor=\"signup-shop-name\" className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n              {t('myShop.shopName')} <span className=\"text-gray-400 text-xs\">({t('common.optional')})</span>\r\n            </label>\r\n            <input\r\n              id=\"signup-shop-name\"\r\n              type=\"text\"\r\n              value={signupShopName}\r\n              onChange={(e) => setSignupShopName(e.target.value)}\r\n              autoComplete=\"organization\"\r\n              className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none\"\r\n              placeholder={t('myShop.shopName')}\r\n            />\r\n          </div>\r\n\r\n          <button\r\n            type=\"button\"\r\n            disabled={signupLoading}\r\n            onClick={async (e) => {\r\n              e.preventDefault();\r\n              e.stopPropagation();\r\n              // Call handler directly with a minimal event object\r\n              const formEvent = {\r\n                preventDefault: () => {},\r\n                stopPropagation: () => {},\r\n              } as unknown as React.FormEvent<HTMLFormElement>;\r\n              await handleSignupSubmit(formEvent);\r\n            }}\r\n            className=\"w-full bg-blue-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n          >\r\n            {signupLoading ? t('auth.creatingAccount') : t('auth.signUp')}\r\n          </button>\r\n        </form>\r\n\r\n        <p className=\"mt-6 text-center text-sm text-gray-600\">\r\n          {t('auth.alreadyHaveAccount')}{' '}\r\n          <button\r\n            onClick={() => {\r\n              setShowSignupModal(false);\r\n              setShowLoginModal(true);\r\n            }}\r\n            className=\"text-blue-600 hover:text-blue-700 font-medium\"\r\n          >\r\n            {t('auth.signIn')}\r\n          </button>\r\n        </p>\r\n      </Modal>\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":"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"}