{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/81704/bookyo/apps/dashboard/app/%28owner%29/settings/page.tsx"],"sourcesContent":["// apps/dashboard/app/(owner)/settings/page.tsx\r\n\"use client\";\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useAuth } from '@/lib/useAuth';\r\n\r\nconst LANGUAGE_OPTIONS = [\r\n  { code: 'en', name: 'English', flag: 'ðŸ‡ºðŸ‡¸' },\r\n  { code: 'ja', name: 'Japanese', flag: 'ðŸ‡¯ðŸ‡µ' },\r\n  { code: 'zh', name: 'Chinese', flag: 'ðŸ‡¨ðŸ‡³' },\r\n  { code: 'vi', name: 'Vietnamese', flag: 'ðŸ‡»ðŸ‡³' },\r\n  { code: 'pt', name: 'Portuguese', flag: 'ðŸ‡µðŸ‡¹' },\r\n  { code: 'fr', name: 'French', flag: 'ðŸ‡«ðŸ‡·' },\r\n  { code: 'ru', name: 'Russian', flag: 'ðŸ‡·ðŸ‡º' },\r\n  { code: 'es', name: 'Spanish', flag: 'ðŸ‡ªðŸ‡¸' },\r\n  { code: 'ko', name: 'Korean', flag: 'ðŸ‡°ðŸ‡·' },\r\n  { code: 'th', name: 'Thai', flag: 'ðŸ‡¹ðŸ‡­' },\r\n  { code: 'de', name: 'German', flag: 'ðŸ‡©ðŸ‡ª' },\r\n  { code: 'it', name: 'Italian', flag: 'ðŸ‡®ðŸ‡¹' },\r\n  { code: 'ar', name: 'Arabic', flag: 'ðŸ‡¸ðŸ‡¦' },\r\n  { code: 'hi', name: 'Hindi', flag: 'ðŸ‡®ðŸ‡³' },\r\n];\r\n\r\nexport default function SettingsPage() {\r\n  const { user } = useAuth();\r\n  const [preferredLanguage, setPreferredLanguage] = useState<string>('en');\r\n  const [loading, setLoading] = useState(true);\r\n  const [saving, setSaving] = useState(false);\r\n  const [message, setMessage] = useState<{ type: 'success' | 'error'; text: string } | null>(null);\r\n  const apiUrl = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3000';\r\n\r\n  useEffect(() => {\r\n    if (user?.id) {\r\n      loadPreferences();\r\n    }\r\n  }, [user]);\r\n\r\n  const loadPreferences = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const res = await fetch(`${apiUrl}/users/me`, {\r\n        headers: {\r\n          'x-user-id': user?.id || '',\r\n        },\r\n      });\r\n\r\n      if (res.ok) {\r\n        const data = await res.json();\r\n        setPreferredLanguage(data.preferredLanguage || 'en');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading preferences:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const savePreferences = async () => {\r\n    if (!user?.id) return;\r\n\r\n    try {\r\n      setSaving(true);\r\n      setMessage(null);\r\n\r\n      const res = await fetch(`${apiUrl}/users/me/preferences`, {\r\n        method: 'PATCH',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'x-user-id': user.id,\r\n        },\r\n        body: JSON.stringify({\r\n          preferredLanguage,\r\n        }),\r\n      });\r\n\r\n      const responseData = await res.json();\r\n\r\n      if (res.ok) {\r\n        setMessage({ type: 'success', text: 'Preferences saved successfully!' });\r\n        setTimeout(() => {\r\n          window.location.reload();\r\n        }, 1000);\r\n      } else {\r\n        // Show the actual error message from the API\r\n        const errorMessage = responseData.error || 'Failed to save preferences';\r\n        const errorDetails = responseData.details ? `: ${responseData.details}` : '';\r\n        console.error('API Error:', responseData);\r\n        setMessage({ type: 'error', text: `${errorMessage}${errorDetails}` });\r\n      }\r\n    } catch (error: any) {\r\n      console.error('Error saving preferences:', error);\r\n      setMessage({ type: 'error', text: `Failed to save preferences: ${error.message || 'Network error'}` });\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"p-8 flex items-center justify-center min-h-screen\">\r\n        <div className=\"text-center\">\r\n          <div className=\"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\r\n          <p className=\"mt-4 text-gray-600\">Loading settings...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"p-8 max-w-4xl mx-auto\">\r\n      <h1 className=\"text-3xl font-bold text-gray-900 mb-8\">Settings</h1>\r\n\r\n      <div className=\"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6\">\r\n        <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">Language Preferences</h2>\r\n        <p className=\"text-gray-600 mb-6\">\r\n          Choose your preferred language. All customer conversations will be translated to this language for you.\r\n        </p>\r\n\r\n        <div className=\"space-y-3\">\r\n          {LANGUAGE_OPTIONS.map((lang) => (\r\n            <label\r\n              key={lang.code}\r\n              className={`flex items-center gap-3 p-4 rounded-lg border-2 cursor-pointer transition-all ${\r\n                preferredLanguage === lang.code\r\n                  ? 'border-blue-500 bg-blue-50'\r\n                  : 'border-gray-200 hover:border-gray-300 hover:bg-gray-50'\r\n              }`}\r\n            >\r\n              <input\r\n                type=\"radio\"\r\n                name=\"preferredLanguage\"\r\n                value={lang.code}\r\n                checked={preferredLanguage === lang.code}\r\n                onChange={(e) => setPreferredLanguage(e.target.value)}\r\n                className=\"w-5 h-5 text-blue-600 focus:ring-blue-500\"\r\n              />\r\n              <span className=\"text-2xl\">{lang.flag}</span>\r\n              <span className=\"text-lg font-medium text-gray-900\">{lang.name}</span>\r\n            </label>\r\n          ))}\r\n        </div>\r\n\r\n        <button\r\n          onClick={savePreferences}\r\n          disabled={saving}\r\n          className=\"mt-6 px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n        >\r\n          {saving ? 'Saving...' : 'Save Preferences'}\r\n        </button>\r\n\r\n        {message && (\r\n          <div\r\n            className={`mt-4 p-4 rounded-lg ${\r\n              message.type === 'success'\r\n                ? 'bg-green-50 text-green-800 border border-green-200'\r\n                : 'bg-red-50 text-red-800 border border-red-200'\r\n            }`}\r\n          >\r\n            {message.text}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":"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"}}]
}