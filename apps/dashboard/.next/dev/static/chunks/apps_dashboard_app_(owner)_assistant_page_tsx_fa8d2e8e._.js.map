{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/81704/bookyo/apps/dashboard/app/%28owner%29/assistant/page.tsx"],"sourcesContent":["// apps/dashboard/app/(owner)/assistant/page.tsx\r\n// AI Assistant page for shop owners with customer message threads\r\n\r\n\"use client\";\r\nimport React, { useState, useRef, useEffect } from 'react';\r\nimport { useAuth } from '@/lib/useAuth';\r\nimport { getSupabaseClient } from '@/lib/supabaseClient';\r\nimport { useTranslations } from 'next-intl';\r\nimport { apiUrl } from '@/lib/apiClient';\r\n\r\ninterface Thread {\r\n  id: string;\r\n  shopId: string;\r\n  bookingId: string | null;\r\n  customerEmail: string | null;\r\n  unreadCount: number;\r\n  lastMessageAt: string;\r\n  lastMessagePreview: string | null;\r\n  lastMessageFrom: string | null;\r\n  ownerTakenOver?: boolean;\r\n}\r\n\r\ninterface ChatMessage {\r\n  id: string;\r\n  senderType: 'customer' | 'owner' | 'ai';\r\n  content: string;\r\n  createdAt: string;\r\n  readByOwner: boolean;\r\n  readByCustomer: boolean;\r\n  senderId?: string | null;\r\n  originalContent?: string; // Original content before translation (for owner messages)\r\n  translatedContent?: string; // Translated content (for customer/AI messages)\r\n}\r\n\r\nexport default function AssistantPage() {\r\n  const { user } = useAuth();\r\n  const t = useTranslations();\r\n  const [threads, setThreads] = useState<Thread[]>([]);\r\n  const [selectedThreadId, setSelectedThreadId] = useState<string | null>(null);\r\n  const [messages, setMessages] = useState<ChatMessage[]>([]);\r\n  const [input, setInput] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const [loadingThreads, setLoadingThreads] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [ownerTakenOver, setOwnerTakenOver] = useState(false);\r\n  const [isTyping, setIsTyping] = useState(false);\r\n  const [translatingMessages, setTranslatingMessages] = useState<Set<string>>(new Set());\r\n  const [ownerPreferredLanguage, setOwnerPreferredLanguage] = useState<string>('en');\r\n  const messagesEndRef = useRef<HTMLDivElement>(null);\r\n  const subscriptionRef = useRef<any>(null);\r\n  const typingTimeoutRef = useRef<NodeJS.Timeout | null>(null);\r\n\r\n  // Auto-scroll to bottom when new messages arrive\r\n  useEffect(() => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  }, [messages]);\r\n\r\n  // Load threads and owner preferences on mount\r\n  useEffect(() => {\r\n    if (user?.id) {\r\n      loadThreads();\r\n      loadOwnerPreferences();\r\n    }\r\n  }, [user]);\r\n\r\n  const loadOwnerPreferences = async () => {\r\n    try {\r\n      const res = await fetch(`${apiUrl}/users/me`, {\r\n        headers: {\r\n          'x-user-id': user?.id || '',\r\n        },\r\n      });\r\n      if (res.ok) {\r\n        const data = await res.json();\r\n        setOwnerPreferredLanguage(data.preferredLanguage || 'en');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading owner preferences:', error);\r\n    }\r\n  };\r\n\r\n  // Load messages when thread is selected\r\n  useEffect(() => {\r\n    if (selectedThreadId) {\r\n      loadMessages(selectedThreadId);\r\n      subscribeToMessages(selectedThreadId);\r\n      markAsRead(selectedThreadId);\r\n    }\r\n\r\n    // Cleanup subscription on thread change\r\n    return () => {\r\n      if (subscriptionRef.current) {\r\n        const supabase = getSupabaseClient();\r\n        supabase.removeChannel(subscriptionRef.current);\r\n      }\r\n    };\r\n  }, [selectedThreadId]);\r\n\r\n  // Cleanup on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      if (subscriptionRef.current) {\r\n        const supabase = getSupabaseClient();\r\n        supabase.removeChannel(subscriptionRef.current);\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  const loadThreads = async () => {\r\n    try {\r\n      setLoadingThreads(true);\r\n      const res = await fetch(`${apiUrl}/messages/owner/threads`, {\r\n        headers: {\r\n          'x-user-id': user?.id || '',\r\n        },\r\n      });\r\n\r\n      if (res.ok) {\r\n        const data = await res.json();\r\n        setThreads(Array.isArray(data) ? data : []);\r\n      } else {\r\n        console.error('Failed to load threads');\r\n        setThreads([]);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading threads:', error);\r\n      setThreads([]);\r\n    } finally {\r\n      setLoadingThreads(false);\r\n    }\r\n  };\r\n\r\n  const loadMessages = async (threadId: string) => {\r\n    try {\r\n      const res = await fetch(`${apiUrl}/messages/thread/${threadId}`);\r\n      if (res.ok) {\r\n        const data = await res.json();\r\n        const messagesData = Array.isArray(data) ? data : [];\r\n        \r\n        // Load takeover status\r\n        const thread = threads.find(t => t.id === threadId);\r\n        if (thread) {\r\n          setOwnerTakenOver(thread.ownerTakenOver || false);\r\n        }\r\n        \r\n        // Translate customer/AI messages to owner's preferred language\r\n        const translatedMessages = await Promise.all(\r\n          messagesData.map(async (msg: ChatMessage) => {\r\n            if (msg.senderType === 'owner') {\r\n              // Owner messages: use originalContent if available\r\n              return {\r\n                ...msg,\r\n                originalContent: msg.originalContent || msg.content,\r\n                translatedContent: msg.content, // Owner's message is already in their language\r\n              };\r\n            } else if (msg.senderType === 'customer' || msg.senderType === 'ai') {\r\n              // Detect message language and translate to owner's preferred language if needed\r\n              // Simple heuristic to detect if message is already in owner's language\r\n              const needsTranslation = msg.content && !msg.translatedContent;\r\n              \r\n              if (needsTranslation) {\r\n                try {\r\n                  const translateRes = await fetch(`${apiUrl}/ai/translate`, {\r\n                    method: 'POST',\r\n                    headers: { 'Content-Type': 'application/json' },\r\n                    body: JSON.stringify({\r\n                      text: msg.content,\r\n                      targetLanguage: ownerPreferredLanguage,\r\n                      sourceLanguage: 'auto', // Auto-detect source language\r\n                    }),\r\n                  });\r\n                  \r\n                  if (translateRes.ok) {\r\n                    const translateData = await translateRes.json();\r\n                    return {\r\n                      ...msg,\r\n                      originalContent: msg.content,\r\n                      translatedContent: translateData.translatedText || msg.content,\r\n                      detectedLanguage: translateData.sourceLanguage,\r\n                    };\r\n                  }\r\n                } catch (translateError) {\r\n                  console.error('Error translating message:', translateError);\r\n                }\r\n              }\r\n              \r\n              return {\r\n                ...msg,\r\n                originalContent: msg.content,\r\n                translatedContent: msg.translatedContent || msg.content,\r\n              };\r\n            }\r\n            return msg;\r\n          })\r\n        );\r\n        \r\n        setMessages(translatedMessages);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading messages:', error);\r\n    }\r\n  };\r\n  \r\n  const toggleTakeover = async () => {\r\n    if (!selectedThreadId) return;\r\n    \r\n    const newTakenOver = !ownerTakenOver;\r\n    setOwnerTakenOver(newTakenOver);\r\n    \r\n    try {\r\n      const res = await fetch(`${apiUrl}/messages/thread/${selectedThreadId}/takeover`, {\r\n        method: 'PATCH',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ takenOver: newTakenOver }),\r\n      });\r\n      \r\n      if (!res.ok) {\r\n        // Revert on error\r\n        setOwnerTakenOver(!newTakenOver);\r\n        console.error('Failed to toggle takeover');\r\n      } else {\r\n        // Update thread in list\r\n        setThreads((prev) =>\r\n          prev.map((thread) =>\r\n            thread.id === selectedThreadId\r\n              ? { ...thread, ownerTakenOver: newTakenOver }\r\n              : thread\r\n          )\r\n        );\r\n      }\r\n    } catch (error) {\r\n      console.error('Error toggling takeover:', error);\r\n      setOwnerTakenOver(!newTakenOver);\r\n    }\r\n  };\r\n\r\n  const markAsRead = async (threadId: string) => {\r\n    try {\r\n      await fetch(`${apiUrl}/messages/thread/${threadId}/mark-read-owner`, {\r\n        method: 'POST',\r\n      });\r\n      \r\n      // Update local unread count\r\n      setThreads((prev) =>\r\n        prev.map((thread) =>\r\n          thread.id === threadId ? { ...thread, unreadCount: 0 } : thread\r\n        )\r\n      );\r\n    } catch (error) {\r\n      console.error('Error marking as read:', error);\r\n    }\r\n  };\r\n\r\n  const subscribeToMessages = (threadId: string) => {\r\n    const supabase = getSupabaseClient();\r\n    \r\n    const channel = supabase\r\n      .channel(`shop_messages:thread_id=eq.${threadId}`)\r\n      .on(\r\n        'postgres_changes',\r\n        {\r\n          event: 'INSERT',\r\n          schema: 'public',\r\n          table: 'shop_messages',\r\n          filter: `thread_id=eq.${threadId}`,\r\n        },\r\n        async (payload: any) => {\r\n          const newMessage = payload.new;\r\n          if (newMessage && newMessage.thread_id === threadId) {\r\n            setMessages((prev) => {\r\n              const exists = prev.some((msg) => msg.id === newMessage.id);\r\n              if (exists) return prev;\r\n              \r\n              // Translate customer/AI messages to English for owner\r\n              const messageData: ChatMessage = {\r\n                id: newMessage.id,\r\n                senderType: newMessage.sender_type,\r\n                content: newMessage.content,\r\n                createdAt: newMessage.created_at,\r\n                readByOwner: newMessage.read_by_owner || false,\r\n                readByCustomer: newMessage.read_by_customer || false,\r\n                senderId: newMessage.sender_id || null,\r\n                originalContent: newMessage.content,\r\n                translatedContent: newMessage.content,\r\n              };\r\n              \r\n              // If customer/AI message, translate to owner's preferred language\r\n              if (newMessage.sender_type === 'customer' || newMessage.sender_type === 'ai') {\r\n                // Translate asynchronously\r\n                fetch(`${apiUrl}/ai/translate`, {\r\n                  method: 'POST',\r\n                  headers: { 'Content-Type': 'application/json' },\r\n                  body: JSON.stringify({\r\n                    text: newMessage.content,\r\n                    targetLanguage: ownerPreferredLanguage,\r\n                    sourceLanguage: 'auto', // Auto-detect source language\r\n                  }),\r\n                })\r\n                  .then(res => res.json())\r\n                  .then(data => {\r\n                    setMessages((prev) =>\r\n                      prev.map((msg) =>\r\n                        msg.id === newMessage.id\r\n                          ? { ...msg, translatedContent: data.translatedText || msg.content, detectedLanguage: data.sourceLanguage }\r\n                          : msg\r\n                      )\r\n                    );\r\n                  })\r\n                  .catch(err => console.error('Error translating new message:', err));\r\n              }\r\n              \r\n              return [...prev, messageData];\r\n            });\r\n\r\n            // Update thread last message\r\n            setThreads((prev) =>\r\n              prev.map((thread) =>\r\n                thread.id === threadId\r\n                  ? {\r\n                      ...thread,\r\n                      lastMessageAt: newMessage.created_at,\r\n                      lastMessagePreview: newMessage.content?.substring(0, 100) || null,\r\n                      lastMessageFrom: newMessage.sender_type,\r\n                      unreadCount:\r\n                        newMessage.sender_type === 'customer' && !newMessage.read_by_owner\r\n                          ? thread.unreadCount + 1\r\n                          : thread.unreadCount,\r\n                    }\r\n                  : thread\r\n              )\r\n            );\r\n          }\r\n        }\r\n      )\r\n      .subscribe();\r\n\r\n    subscriptionRef.current = channel;\r\n  };\r\n\r\n  // Handle typing indicator\r\n  useEffect(() => {\r\n    if (input.trim() && selectedThreadId) {\r\n      setIsTyping(true);\r\n      \r\n      // Clear existing timeout\r\n      if (typingTimeoutRef.current) {\r\n        clearTimeout(typingTimeoutRef.current);\r\n      }\r\n      \r\n      // Set timeout to hide typing indicator after 2 seconds of no typing\r\n      typingTimeoutRef.current = setTimeout(() => {\r\n        setIsTyping(false);\r\n      }, 2000);\r\n    } else {\r\n      setIsTyping(false);\r\n    }\r\n    \r\n    return () => {\r\n      if (typingTimeoutRef.current) {\r\n        clearTimeout(typingTimeoutRef.current);\r\n      }\r\n    };\r\n  }, [input, selectedThreadId]);\r\n\r\n  const inputRef = useRef<HTMLInputElement>(null);\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    \r\n    if (!input.trim() || loading || !selectedThreadId) {\r\n      return;\r\n    }\r\n\r\n    setIsTyping(false);\r\n    const messageContent = input.trim();\r\n    setInput('');\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const res = await fetch(`${apiUrl}/messages/thread/${selectedThreadId}/send`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          senderType: 'owner',\r\n          senderId: user?.id || null,\r\n          content: messageContent,\r\n        }),\r\n      });\r\n\r\n      if (!res.ok) {\r\n        const errorData = await res.json().catch(() => ({ error: 'Failed to send message' }));\r\n        throw new Error(errorData.error || `HTTP error! status: ${res.status}`);\r\n      }\r\n\r\n      const sentMessage = await res.json();\r\n      \r\n      // Add message to local state (realtime will also add it, but this is immediate)\r\n      setMessages((prev) => {\r\n        const exists = prev.some((msg) => msg.id === sentMessage.id);\r\n        if (exists) return prev;\r\n        return [...prev, sentMessage];\r\n      });\r\n\r\n      // Update thread last message\r\n      setThreads((prev) =>\r\n        prev.map((thread) =>\r\n          thread.id === selectedThreadId\r\n            ? {\r\n                ...thread,\r\n                lastMessageAt: sentMessage.createdAt,\r\n                lastMessagePreview: sentMessage.content?.substring(0, 100) || null,\r\n                lastMessageFrom: 'owner',\r\n              }\r\n            : thread\r\n        )\r\n      );\r\n\r\n      // Trigger AI response for owner messages (calendar commands, etc.)\r\n      // Get shop ID from thread\r\n      const currentThread = threads.find(t => t.id === selectedThreadId);\r\n      if (currentThread?.shopId) {\r\n        try {\r\n          await fetch(`${apiUrl}/ai/chat-thread`, {\r\n            method: 'POST',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify({\r\n              threadId: selectedThreadId,\r\n              shopId: currentThread.shopId,\r\n              message: messageContent,\r\n              source: 'owner',\r\n            }),\r\n          });\r\n        } catch (aiError) {\r\n          // Silently handle AI errors - not critical for message sending\r\n          console.error('Error triggering AI response:', aiError);\r\n        }\r\n      }\r\n    } catch (err) {\r\n      console.error('Error sending message:', err);\r\n      setError(err instanceof Error ? err.message : 'Failed to send message');\r\n    } finally {\r\n      setLoading(false);\r\n      // Keep input focused after sending\r\n      setTimeout(() => {\r\n        inputRef.current?.focus();\r\n      }, 100);\r\n    }\r\n  };\r\n\r\n  const formatTime = (dateString: string) => {\r\n    const date = new Date(dateString);\r\n    return new Intl.DateTimeFormat('en-US', {\r\n      hour: 'numeric',\r\n      minute: '2-digit',\r\n    }).format(date);\r\n  };\r\n\r\n  const formatDate = (dateString: string) => {\r\n    const date = new Date(dateString);\r\n    return new Intl.DateTimeFormat('en-US', {\r\n      month: 'short',\r\n      day: 'numeric',\r\n      hour: 'numeric',\r\n      minute: '2-digit',\r\n    }).format(date);\r\n  };\r\n\r\n  const selectedThread = threads.find((t) => t.id === selectedThreadId);\r\n\r\n  return (\r\n    <div className=\"p-8 bg-gray-50 min-h-screen\">\r\n      <div className=\"mb-6\">\r\n        <h1 className=\"text-3xl font-bold text-gray-800 mb-2\">{t('assistant.title')}</h1>\r\n        <p className=\"text-gray-600\">{t('assistant.subtitle')}</p>\r\n      </div>\r\n\r\n      <div className=\"bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden\">\r\n        <div className=\"flex h-[calc(100vh-280px)] min-h-[600px]\">\r\n          {/* Left: Thread List */}\r\n          <div className=\"w-80 border-r border-gray-200 flex flex-col bg-gray-50\">\r\n            <div className=\"px-6 py-4 border-b border-gray-200 bg-white\">\r\n              <h2 className=\"text-lg font-semibold text-gray-800\">{t('assistant.customerConversations')}</h2>\r\n            </div>\r\n            \r\n            <div className=\"flex-1 overflow-y-auto bg-white\">\r\n              {loadingThreads ? (\r\n                <div className=\"p-6 text-center text-gray-500\">{t('assistant.loadingThreads')}</div>\r\n              ) : threads.length === 0 ? (\r\n                <div className=\"p-6 text-center text-gray-500\">\r\n                  <p>{t('assistant.noConversations')}</p>\r\n                </div>\r\n              ) : (\r\n                <div className=\"divide-y divide-gray-100\">\r\n                  {threads.map((thread) => (\r\n                    <button\r\n                      key={thread.id}\r\n                      onClick={() => setSelectedThreadId(thread.id)}\r\n                      className={`w-full text-left px-4 py-3 hover:bg-blue-50 transition-colors ${\r\n                        selectedThreadId === thread.id ? 'bg-blue-50 border-l-4 border-blue-600' : ''\r\n                      }`}\r\n                    >\r\n                      <div className=\"flex items-start gap-3\">\r\n                        <div className=\"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0\">\r\n                          <span className=\"text-lg\">ðŸ‘¤</span>\r\n                        </div>\r\n                        <div className=\"flex-1 min-w-0\">\r\n                          <div className=\"flex items-center justify-between mb-1\">\r\n                            <p className=\"text-sm font-semibold text-gray-900 truncate\">\r\n                              {thread.customerEmail || `Thread ${thread.id.substring(0, 8)}`}\r\n                            </p>\r\n                            {thread.unreadCount > 0 && (\r\n                              <span className=\"ml-2 flex-shrink-0 bg-blue-600 text-white text-xs font-semibold rounded-full px-2 py-0.5 min-w-[20px] text-center\">\r\n                                {thread.unreadCount}\r\n                              </span>\r\n                            )}\r\n                          </div>\r\n                          {thread.lastMessagePreview && (\r\n                            <p className=\"text-xs text-gray-500 truncate mb-1\">\r\n                              {thread.lastMessagePreview}\r\n                            </p>\r\n                          )}\r\n                          <p className=\"text-xs text-gray-400\">\r\n                            {formatDate(thread.lastMessageAt)}\r\n                          </p>\r\n                        </div>\r\n                      </div>\r\n                    </button>\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Right: Messages */}\r\n          <div className=\"flex-1 flex flex-col bg-gray-50\">\r\n            {selectedThreadId ? (\r\n              <>\r\n                <div className=\"px-6 py-4 border-b border-gray-200 bg-white flex items-center justify-between shadow-sm\">\r\n                  <div className=\"flex items-center gap-3\">\r\n                    <div className=\"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center\">\r\n                      <span className=\"text-lg\">ðŸ‘¤</span>\r\n                    </div>\r\n                    <div>\r\n                      <h2 className=\"text-lg font-semibold text-gray-800\">\r\n                        {selectedThread?.customerEmail || `Thread ${selectedThreadId.substring(0, 8)}`}\r\n                      </h2>\r\n                      {selectedThread?.bookingId && (\r\n                        <p className=\"text-sm text-gray-500\">{t('assistant.booking')} {selectedThread.bookingId.substring(0, 8)}</p>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                  <button\r\n                    onClick={toggleTakeover}\r\n                    className={`px-4 py-2 rounded-lg font-medium transition-colors ${\r\n                      ownerTakenOver\r\n                        ? 'bg-green-600 text-white hover:bg-green-700'\r\n                        : 'bg-gray-200 text-gray-700 hover:bg-gray-300'\r\n                    }`}\r\n                  >\r\n                    {ownerTakenOver ? t('assistant.youAreHandling') : t('assistant.letAiHandle')}\r\n                  </button>\r\n                </div>\r\n                \r\n                <div className=\"flex-1 overflow-y-auto p-6 space-y-4 bg-gray-50\">\r\n                  {messages.length === 0 ? (\r\n                    <div className=\"flex items-center justify-center h-full\">\r\n                      <div className=\"text-center\">\r\n                        <div className=\"text-6xl mb-4\">ðŸ’¬</div>\r\n                        <h3 className=\"text-xl font-semibold text-gray-800 mb-2\">{t('assistant.noMessages')}</h3>\r\n                        <p className=\"text-gray-600\">{t('assistant.startConversation')}</p>\r\n                      </div>\r\n                    </div>\r\n                  ) : (\r\n                    <>\r\n                      {messages.map((message) => (\r\n                        <div\r\n                          key={message.id}\r\n                          className={`flex gap-3 ${\r\n                            message.senderType === 'owner' ? 'justify-end' : 'justify-start'\r\n                          }`}\r\n                        >\r\n                          {message.senderType !== 'owner' && (\r\n                            <div className=\"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0\">\r\n                              <span className=\"text-lg\">\r\n                                {message.senderType === 'ai' ? 'ðŸ¤–' : 'ðŸ‘¤'}\r\n                              </span>\r\n                            </div>\r\n                          )}\r\n                          <div\r\n                            className={`max-w-[75%] rounded-lg px-4 py-3 shadow-sm ${\r\n                              message.senderType === 'owner'\r\n                                ? 'bg-blue-600 text-white'\r\n                                : 'bg-white text-gray-800 border border-gray-200'\r\n                            }`}\r\n                          >\r\n                            <p className=\"whitespace-pre-wrap break-words\">\r\n                              {message.senderType === 'owner' \r\n                                ? (message.originalContent || message.content)\r\n                                : (message.translatedContent || message.content)\r\n                              }\r\n                            </p>\r\n                            {(message.senderType === 'customer' || message.senderType === 'ai') && \r\n                             message.originalContent && \r\n                             message.originalContent !== message.translatedContent && (\r\n                              <p className=\"text-xs mt-1 opacity-75 italic\">\r\n                                ðŸ‡¯ðŸ‡µ {message.originalContent.substring(0, 50)}\r\n                                {message.originalContent.length > 50 ? '...' : ''}\r\n                              </p>\r\n                            )}\r\n                            <p\r\n                              className={`text-xs mt-2 ${\r\n                                message.senderType === 'owner' ? 'text-blue-100' : 'text-gray-500'\r\n                              }`}\r\n                            >\r\n                              {formatTime(message.createdAt)}\r\n                            </p>\r\n                          </div>\r\n                          {message.senderType === 'owner' && (\r\n                            <div className=\"w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center flex-shrink-0\">\r\n                              <span className=\"text-sm font-semibold text-gray-600\">You</span>\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n                      ))}\r\n                      {isTyping && (\r\n                        <div className=\"flex gap-3 justify-end\">\r\n                          <div className=\"bg-gray-100 rounded-lg px-4 py-3\">\r\n                            <div className=\"flex items-center gap-2\">\r\n                              <div className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\"></div>\r\n                              <div className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\" style={{ animationDelay: '0.2s' }}></div>\r\n                              <div className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\" style={{ animationDelay: '0.4s' }}></div>\r\n                              <span className=\"text-xs text-gray-500 ml-2\">{t('assistant.youAreTyping')}</span>\r\n                            </div>\r\n                          </div>\r\n                          <div className=\"w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center flex-shrink-0\">\r\n                            <span className=\"text-sm font-semibold text-gray-600\">You</span>\r\n                          </div>\r\n                        </div>\r\n                      )}\r\n                      {loading && (\r\n                        <div className=\"flex gap-3 justify-start\">\r\n                          <div className=\"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0\">\r\n                            <span className=\"text-lg\">ðŸ¤–</span>\r\n                          </div>\r\n                          <div className=\"bg-gray-100 rounded-lg px-4 py-3\">\r\n                            <div className=\"flex items-center gap-2\">\r\n                              <div className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\"></div>\r\n                              <div className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\" style={{ animationDelay: '0.2s' }}></div>\r\n                              <div className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\" style={{ animationDelay: '0.4s' }}></div>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      )}\r\n                      <div ref={messagesEndRef} />\r\n                    </>\r\n                  )}\r\n                </div>\r\n\r\n                <div className=\"px-6 py-4 border-t border-gray-200 bg-white sticky bottom-0\">\r\n                  {error && (\r\n                    <div className=\"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm\">\r\n                      {error}\r\n                    </div>\r\n                  )}\r\n                  <form onSubmit={handleSubmit} className=\"flex gap-2\">\r\n                    <input\r\n                      ref={inputRef}\r\n                      type=\"text\"\r\n                      value={input}\r\n                      onChange={(e) => setInput(e.target.value)}\r\n                      placeholder={t('assistant.typeMessage')}\r\n                      className=\"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none\"\r\n                      disabled={loading}\r\n                      autoFocus\r\n                    />\r\n                    <button\r\n                      type=\"submit\"\r\n                      disabled={!input.trim() || loading}\r\n                      className=\"px-6 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n                    >\r\n                      {loading ? t('assistant.sending') : t('assistant.send')}\r\n                    </button>\r\n                  </form>\r\n                </div>\r\n              </>\r\n            ) : (\r\n              <div className=\"flex items-center justify-center h-full bg-gray-50\">\r\n                <div className=\"text-center\">\r\n                  <div className=\"text-6xl mb-4\">ðŸ’¬</div>\r\n                  <h3 className=\"text-xl font-semibold text-gray-800 mb-2\">{t('assistant.selectConversation')}</h3>\r\n                  <p className=\"text-gray-600\">{t('assistant.selectConversationDesc')}</p>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"AAAA,gDAAgD;AAChD,kEAAkE;;;;;;AAGlE;AACA;AACA;AACA;AACA;;;AALA;;;;;;AA+Be,SAAS;;IACtB,MAAM,EAAE,IAAI,EAAE,GAAG,IAAA,kJAAO;IACxB,MAAM,IAAI,IAAA,4MAAe;IACzB,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAW,EAAE;IACnD,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,yKAAQ,EAAgB;IACxE,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAgB,EAAE;IAC1D,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAC;IACnC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IACvC,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,yKAAQ,EAAC;IACrD,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAgB;IAClD,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,yKAAQ,EAAC;IACrD,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAC;IACzC,MAAM,CAAC,qBAAqB,uBAAuB,GAAG,IAAA,yKAAQ,EAAc,IAAI;IAChF,MAAM,CAAC,wBAAwB,0BAA0B,GAAG,IAAA,yKAAQ,EAAS;IAC7E,MAAM,iBAAiB,IAAA,uKAAM,EAAiB;IAC9C,MAAM,kBAAkB,IAAA,uKAAM,EAAM;IACpC,MAAM,mBAAmB,IAAA,uKAAM,EAAwB;IAEvD,iDAAiD;IACjD,IAAA,0KAAS;mCAAC;YACR,eAAe,OAAO,EAAE,eAAe;gBAAE,UAAU;YAAS;QAC9D;kCAAG;QAAC;KAAS;IAEb,8CAA8C;IAC9C,IAAA,0KAAS;mCAAC;YACR,IAAI,MAAM,IAAI;gBACZ;gBACA;YACF;QACF;kCAAG;QAAC;KAAK;IAET,MAAM,uBAAuB;QAC3B,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,GAAG,kJAAM,CAAC,SAAS,CAAC,EAAE;gBAC5C,SAAS;oBACP,aAAa,MAAM,MAAM;gBAC3B;YACF;YACA,IAAI,IAAI,EAAE,EAAE;gBACV,MAAM,OAAO,MAAM,IAAI,IAAI;gBAC3B,0BAA0B,KAAK,iBAAiB,IAAI;YACtD;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,oCAAoC;QACpD;IACF;IAEA,wCAAwC;IACxC,IAAA,0KAAS;mCAAC;YACR,IAAI,kBAAkB;gBACpB,aAAa;gBACb,oBAAoB;gBACpB,WAAW;YACb;YAEA,wCAAwC;YACxC;2CAAO;oBACL,IAAI,gBAAgB,OAAO,EAAE;wBAC3B,MAAM,WAAW,IAAA,kKAAiB;wBAClC,SAAS,aAAa,CAAC,gBAAgB,OAAO;oBAChD;gBACF;;QACF;kCAAG;QAAC;KAAiB;IAErB,qBAAqB;IACrB,IAAA,0KAAS;mCAAC;YACR;2CAAO;oBACL,IAAI,gBAAgB,OAAO,EAAE;wBAC3B,MAAM,WAAW,IAAA,kKAAiB;wBAClC,SAAS,aAAa,CAAC,gBAAgB,OAAO;oBAChD;gBACF;;QACF;kCAAG,EAAE;IAEL,MAAM,cAAc;QAClB,IAAI;YACF,kBAAkB;YAClB,MAAM,MAAM,MAAM,MAAM,GAAG,kJAAM,CAAC,uBAAuB,CAAC,EAAE;gBAC1D,SAAS;oBACP,aAAa,MAAM,MAAM;gBAC3B;YACF;YAEA,IAAI,IAAI,EAAE,EAAE;gBACV,MAAM,OAAO,MAAM,IAAI,IAAI;gBAC3B,WAAW,MAAM,OAAO,CAAC,QAAQ,OAAO,EAAE;YAC5C,OAAO;gBACL,QAAQ,KAAK,CAAC;gBACd,WAAW,EAAE;YACf;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,0BAA0B;YACxC,WAAW,EAAE;QACf,SAAU;YACR,kBAAkB;QACpB;IACF;IAEA,MAAM,eAAe,OAAO;QAC1B,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,GAAG,kJAAM,CAAC,iBAAiB,EAAE,UAAU;YAC/D,IAAI,IAAI,EAAE,EAAE;gBACV,MAAM,OAAO,MAAM,IAAI,IAAI;gBAC3B,MAAM,eAAe,MAAM,OAAO,CAAC,QAAQ,OAAO,EAAE;gBAEpD,uBAAuB;gBACvB,MAAM,SAAS,QAAQ,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;gBAC1C,IAAI,QAAQ;oBACV,kBAAkB,OAAO,cAAc,IAAI;gBAC7C;gBAEA,+DAA+D;gBAC/D,MAAM,qBAAqB,MAAM,QAAQ,GAAG,CAC1C,aAAa,GAAG,CAAC,OAAO;oBACtB,IAAI,IAAI,UAAU,KAAK,SAAS;wBAC9B,mDAAmD;wBACnD,OAAO;4BACL,GAAG,GAAG;4BACN,iBAAiB,IAAI,eAAe,IAAI,IAAI,OAAO;4BACnD,mBAAmB,IAAI,OAAO;wBAChC;oBACF,OAAO,IAAI,IAAI,UAAU,KAAK,cAAc,IAAI,UAAU,KAAK,MAAM;wBACnE,gFAAgF;wBAChF,uEAAuE;wBACvE,MAAM,mBAAmB,IAAI,OAAO,IAAI,CAAC,IAAI,iBAAiB;wBAE9D,IAAI,kBAAkB;4BACpB,IAAI;gCACF,MAAM,eAAe,MAAM,MAAM,GAAG,kJAAM,CAAC,aAAa,CAAC,EAAE;oCACzD,QAAQ;oCACR,SAAS;wCAAE,gBAAgB;oCAAmB;oCAC9C,MAAM,KAAK,SAAS,CAAC;wCACnB,MAAM,IAAI,OAAO;wCACjB,gBAAgB;wCAChB,gBAAgB;oCAClB;gCACF;gCAEA,IAAI,aAAa,EAAE,EAAE;oCACnB,MAAM,gBAAgB,MAAM,aAAa,IAAI;oCAC7C,OAAO;wCACL,GAAG,GAAG;wCACN,iBAAiB,IAAI,OAAO;wCAC5B,mBAAmB,cAAc,cAAc,IAAI,IAAI,OAAO;wCAC9D,kBAAkB,cAAc,cAAc;oCAChD;gCACF;4BACF,EAAE,OAAO,gBAAgB;gCACvB,QAAQ,KAAK,CAAC,8BAA8B;4BAC9C;wBACF;wBAEA,OAAO;4BACL,GAAG,GAAG;4BACN,iBAAiB,IAAI,OAAO;4BAC5B,mBAAmB,IAAI,iBAAiB,IAAI,IAAI,OAAO;wBACzD;oBACF;oBACA,OAAO;gBACT;gBAGF,YAAY;YACd;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,2BAA2B;QAC3C;IACF;IAEA,MAAM,iBAAiB;QACrB,IAAI,CAAC,kBAAkB;QAEvB,MAAM,eAAe,CAAC;QACtB,kBAAkB;QAElB,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,GAAG,kJAAM,CAAC,iBAAiB,EAAE,iBAAiB,SAAS,CAAC,EAAE;gBAChF,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE,WAAW;gBAAa;YACjD;YAEA,IAAI,CAAC,IAAI,EAAE,EAAE;gBACX,kBAAkB;gBAClB,kBAAkB,CAAC;gBACnB,QAAQ,KAAK,CAAC;YAChB,OAAO;gBACL,wBAAwB;gBACxB,WAAW,CAAC,OACV,KAAK,GAAG,CAAC,CAAC,SACR,OAAO,EAAE,KAAK,mBACV;4BAAE,GAAG,MAAM;4BAAE,gBAAgB;wBAAa,IAC1C;YAGV;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,4BAA4B;YAC1C,kBAAkB,CAAC;QACrB;IACF;IAEA,MAAM,aAAa,OAAO;QACxB,IAAI;YACF,MAAM,MAAM,GAAG,kJAAM,CAAC,iBAAiB,EAAE,SAAS,gBAAgB,CAAC,EAAE;gBACnE,QAAQ;YACV;YAEA,4BAA4B;YAC5B,WAAW,CAAC,OACV,KAAK,GAAG,CAAC,CAAC,SACR,OAAO,EAAE,KAAK,WAAW;wBAAE,GAAG,MAAM;wBAAE,aAAa;oBAAE,IAAI;QAG/D,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,0BAA0B;QAC1C;IACF;IAEA,MAAM,sBAAsB,CAAC;QAC3B,MAAM,WAAW,IAAA,kKAAiB;QAElC,MAAM,UAAU,SACb,OAAO,CAAC,CAAC,2BAA2B,EAAE,UAAU,EAChD,EAAE,CACD,oBACA;YACE,OAAO;YACP,QAAQ;YACR,OAAO;YACP,QAAQ,CAAC,aAAa,EAAE,UAAU;QACpC,GACA,OAAO;YACL,MAAM,aAAa,QAAQ,GAAG;YAC9B,IAAI,cAAc,WAAW,SAAS,KAAK,UAAU;gBACnD,YAAY,CAAC;oBACX,MAAM,SAAS,KAAK,IAAI,CAAC,CAAC,MAAQ,IAAI,EAAE,KAAK,WAAW,EAAE;oBAC1D,IAAI,QAAQ,OAAO;oBAEnB,sDAAsD;oBACtD,MAAM,cAA2B;wBAC/B,IAAI,WAAW,EAAE;wBACjB,YAAY,WAAW,WAAW;wBAClC,SAAS,WAAW,OAAO;wBAC3B,WAAW,WAAW,UAAU;wBAChC,aAAa,WAAW,aAAa,IAAI;wBACzC,gBAAgB,WAAW,gBAAgB,IAAI;wBAC/C,UAAU,WAAW,SAAS,IAAI;wBAClC,iBAAiB,WAAW,OAAO;wBACnC,mBAAmB,WAAW,OAAO;oBACvC;oBAEA,kEAAkE;oBAClE,IAAI,WAAW,WAAW,KAAK,cAAc,WAAW,WAAW,KAAK,MAAM;wBAC5E,2BAA2B;wBAC3B,MAAM,GAAG,kJAAM,CAAC,aAAa,CAAC,EAAE;4BAC9B,QAAQ;4BACR,SAAS;gCAAE,gBAAgB;4BAAmB;4BAC9C,MAAM,KAAK,SAAS,CAAC;gCACnB,MAAM,WAAW,OAAO;gCACxB,gBAAgB;gCAChB,gBAAgB;4BAClB;wBACF,GACG,IAAI,CAAC,CAAA,MAAO,IAAI,IAAI,IACpB,IAAI,CAAC,CAAA;4BACJ,YAAY,CAAC,OACX,KAAK,GAAG,CAAC,CAAC,MACR,IAAI,EAAE,KAAK,WAAW,EAAE,GACpB;wCAAE,GAAG,GAAG;wCAAE,mBAAmB,KAAK,cAAc,IAAI,IAAI,OAAO;wCAAE,kBAAkB,KAAK,cAAc;oCAAC,IACvG;wBAGV,GACC,KAAK,CAAC,CAAA,MAAO,QAAQ,KAAK,CAAC,kCAAkC;oBAClE;oBAEA,OAAO;2BAAI;wBAAM;qBAAY;gBAC/B;gBAEA,6BAA6B;gBAC7B,WAAW,CAAC,OACV,KAAK,GAAG,CAAC,CAAC,SACR,OAAO,EAAE,KAAK,WACV;4BACE,GAAG,MAAM;4BACT,eAAe,WAAW,UAAU;4BACpC,oBAAoB,WAAW,OAAO,EAAE,UAAU,GAAG,QAAQ;4BAC7D,iBAAiB,WAAW,WAAW;4BACvC,aACE,WAAW,WAAW,KAAK,cAAc,CAAC,WAAW,aAAa,GAC9D,OAAO,WAAW,GAAG,IACrB,OAAO,WAAW;wBAC1B,IACA;YAGV;QACF,GAED,SAAS;QAEZ,gBAAgB,OAAO,GAAG;IAC5B;IAEA,0BAA0B;IAC1B,IAAA,0KAAS;mCAAC;YACR,IAAI,MAAM,IAAI,MAAM,kBAAkB;gBACpC,YAAY;gBAEZ,yBAAyB;gBACzB,IAAI,iBAAiB,OAAO,EAAE;oBAC5B,aAAa,iBAAiB,OAAO;gBACvC;gBAEA,oEAAoE;gBACpE,iBAAiB,OAAO,GAAG;+CAAW;wBACpC,YAAY;oBACd;8CAAG;YACL,OAAO;gBACL,YAAY;YACd;YAEA;2CAAO;oBACL,IAAI,iBAAiB,OAAO,EAAE;wBAC5B,aAAa,iBAAiB,OAAO;oBACvC;gBACF;;QACF;kCAAG;QAAC;QAAO;KAAiB;IAE5B,MAAM,WAAW,IAAA,uKAAM,EAAmB;IAE1C,MAAM,eAAe,OAAO;QAC1B,EAAE,cAAc;QAEhB,IAAI,CAAC,MAAM,IAAI,MAAM,WAAW,CAAC,kBAAkB;YACjD;QACF;QAEA,YAAY;QACZ,MAAM,iBAAiB,MAAM,IAAI;QACjC,SAAS;QACT,WAAW;QACX,SAAS;QAET,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,GAAG,kJAAM,CAAC,iBAAiB,EAAE,iBAAiB,KAAK,CAAC,EAAE;gBAC5E,QAAQ;gBACR,SAAS;oBACP,gBAAgB;gBAClB;gBACA,MAAM,KAAK,SAAS,CAAC;oBACnB,YAAY;oBACZ,UAAU,MAAM,MAAM;oBACtB,SAAS;gBACX;YACF;YAEA,IAAI,CAAC,IAAI,EAAE,EAAE;gBACX,MAAM,YAAY,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC;wBAAE,OAAO;oBAAyB,CAAC;gBACnF,MAAM,IAAI,MAAM,UAAU,KAAK,IAAI,CAAC,oBAAoB,EAAE,IAAI,MAAM,EAAE;YACxE;YAEA,MAAM,cAAc,MAAM,IAAI,IAAI;YAElC,gFAAgF;YAChF,YAAY,CAAC;gBACX,MAAM,SAAS,KAAK,IAAI,CAAC,CAAC,MAAQ,IAAI,EAAE,KAAK,YAAY,EAAE;gBAC3D,IAAI,QAAQ,OAAO;gBACnB,OAAO;uBAAI;oBAAM;iBAAY;YAC/B;YAEA,6BAA6B;YAC7B,WAAW,CAAC,OACV,KAAK,GAAG,CAAC,CAAC,SACR,OAAO,EAAE,KAAK,mBACV;wBACE,GAAG,MAAM;wBACT,eAAe,YAAY,SAAS;wBACpC,oBAAoB,YAAY,OAAO,EAAE,UAAU,GAAG,QAAQ;wBAC9D,iBAAiB;oBACnB,IACA;YAIR,mEAAmE;YACnE,0BAA0B;YAC1B,MAAM,gBAAgB,QAAQ,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;YACjD,IAAI,eAAe,QAAQ;gBACzB,IAAI;oBACF,MAAM,MAAM,GAAG,kJAAM,CAAC,eAAe,CAAC,EAAE;wBACtC,QAAQ;wBACR,SAAS;4BAAE,gBAAgB;wBAAmB;wBAC9C,MAAM,KAAK,SAAS,CAAC;4BACnB,UAAU;4BACV,QAAQ,cAAc,MAAM;4BAC5B,SAAS;4BACT,QAAQ;wBACV;oBACF;gBACF,EAAE,OAAO,SAAS;oBAChB,+DAA+D;oBAC/D,QAAQ,KAAK,CAAC,iCAAiC;gBACjD;YACF;QACF,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,0BAA0B;YACxC,SAAS,eAAe,QAAQ,IAAI,OAAO,GAAG;QAChD,SAAU;YACR,WAAW;YACX,mCAAmC;YACnC,WAAW;gBACT,SAAS,OAAO,EAAE;YACpB,GAAG;QACL;IACF;IAEA,MAAM,aAAa,CAAC;QAClB,MAAM,OAAO,IAAI,KAAK;QACtB,OAAO,IAAI,KAAK,cAAc,CAAC,SAAS;YACtC,MAAM;YACN,QAAQ;QACV,GAAG,MAAM,CAAC;IACZ;IAEA,MAAM,aAAa,CAAC;QAClB,MAAM,OAAO,IAAI,KAAK;QACtB,OAAO,IAAI,KAAK,cAAc,CAAC,SAAS;YACtC,OAAO;YACP,KAAK;YACL,MAAM;YACN,QAAQ;QACV,GAAG,MAAM,CAAC;IACZ;IAEA,MAAM,iBAAiB,QAAQ,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;IAEpD,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAG,WAAU;kCAAyC,EAAE;;;;;;kCACzD,6LAAC;wBAAE,WAAU;kCAAiB,EAAE;;;;;;;;;;;;0BAGlC,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBAAI,WAAU;;sCAEb,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAI,WAAU;8CACb,cAAA,6LAAC;wCAAG,WAAU;kDAAuC,EAAE;;;;;;;;;;;8CAGzD,6LAAC;oCAAI,WAAU;8CACZ,+BACC,6LAAC;wCAAI,WAAU;kDAAiC,EAAE;;;;;+CAChD,QAAQ,MAAM,KAAK,kBACrB,6LAAC;wCAAI,WAAU;kDACb,cAAA,6LAAC;sDAAG,EAAE;;;;;;;;;;6DAGR,6LAAC;wCAAI,WAAU;kDACZ,QAAQ,GAAG,CAAC,CAAC,uBACZ,6LAAC;gDAEC,SAAS,IAAM,oBAAoB,OAAO,EAAE;gDAC5C,WAAW,CAAC,8DAA8D,EACxE,qBAAqB,OAAO,EAAE,GAAG,0CAA0C,IAC3E;0DAEF,cAAA,6LAAC;oDAAI,WAAU;;sEACb,6LAAC;4DAAI,WAAU;sEACb,cAAA,6LAAC;gEAAK,WAAU;0EAAU;;;;;;;;;;;sEAE5B,6LAAC;4DAAI,WAAU;;8EACb,6LAAC;oEAAI,WAAU;;sFACb,6LAAC;4EAAE,WAAU;sFACV,OAAO,aAAa,IAAI,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC,SAAS,CAAC,GAAG,IAAI;;;;;;wEAE/D,OAAO,WAAW,GAAG,mBACpB,6LAAC;4EAAK,WAAU;sFACb,OAAO,WAAW;;;;;;;;;;;;gEAIxB,OAAO,kBAAkB,kBACxB,6LAAC;oEAAE,WAAU;8EACV,OAAO,kBAAkB;;;;;;8EAG9B,6LAAC;oEAAE,WAAU;8EACV,WAAW,OAAO,aAAa;;;;;;;;;;;;;;;;;;+CA3BjC,OAAO,EAAE;;;;;;;;;;;;;;;;;;;;;sCAuC1B,6LAAC;4BAAI,WAAU;sCACZ,iCACC;;kDACE,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDAAI,WAAU;;kEACb,6LAAC;wDAAI,WAAU;kEACb,cAAA,6LAAC;4DAAK,WAAU;sEAAU;;;;;;;;;;;kEAE5B,6LAAC;;0EACC,6LAAC;gEAAG,WAAU;0EACX,gBAAgB,iBAAiB,CAAC,OAAO,EAAE,iBAAiB,SAAS,CAAC,GAAG,IAAI;;;;;;4DAE/E,gBAAgB,2BACf,6LAAC;gEAAE,WAAU;;oEAAyB,EAAE;oEAAqB;oEAAE,eAAe,SAAS,CAAC,SAAS,CAAC,GAAG;;;;;;;;;;;;;;;;;;;0DAI3G,6LAAC;gDACC,SAAS;gDACT,WAAW,CAAC,mDAAmD,EAC7D,iBACI,+CACA,+CACJ;0DAED,iBAAiB,EAAE,8BAA8B,EAAE;;;;;;;;;;;;kDAIxD,6LAAC;wCAAI,WAAU;kDACZ,SAAS,MAAM,KAAK,kBACnB,6LAAC;4CAAI,WAAU;sDACb,cAAA,6LAAC;gDAAI,WAAU;;kEACb,6LAAC;wDAAI,WAAU;kEAAgB;;;;;;kEAC/B,6LAAC;wDAAG,WAAU;kEAA4C,EAAE;;;;;;kEAC5D,6LAAC;wDAAE,WAAU;kEAAiB,EAAE;;;;;;;;;;;;;;;;iEAIpC;;gDACG,SAAS,GAAG,CAAC,CAAC,wBACb,6LAAC;wDAEC,WAAW,CAAC,WAAW,EACrB,QAAQ,UAAU,KAAK,UAAU,gBAAgB,iBACjD;;4DAED,QAAQ,UAAU,KAAK,yBACtB,6LAAC;gEAAI,WAAU;0EACb,cAAA,6LAAC;oEAAK,WAAU;8EACb,QAAQ,UAAU,KAAK,OAAO,OAAO;;;;;;;;;;;0EAI5C,6LAAC;gEACC,WAAW,CAAC,2CAA2C,EACrD,QAAQ,UAAU,KAAK,UACnB,2BACA,iDACJ;;kFAEF,6LAAC;wEAAE,WAAU;kFACV,QAAQ,UAAU,KAAK,UACnB,QAAQ,eAAe,IAAI,QAAQ,OAAO,GAC1C,QAAQ,iBAAiB,IAAI,QAAQ,OAAO;;;;;;oEAGlD,CAAC,QAAQ,UAAU,KAAK,cAAc,QAAQ,UAAU,KAAK,IAAI,KACjE,QAAQ,eAAe,IACvB,QAAQ,eAAe,KAAK,QAAQ,iBAAiB,kBACpD,6LAAC;wEAAE,WAAU;;4EAAiC;4EACtC,QAAQ,eAAe,CAAC,SAAS,CAAC,GAAG;4EAC1C,QAAQ,eAAe,CAAC,MAAM,GAAG,KAAK,QAAQ;;;;;;;kFAGnD,6LAAC;wEACC,WAAW,CAAC,aAAa,EACvB,QAAQ,UAAU,KAAK,UAAU,kBAAkB,iBACnD;kFAED,WAAW,QAAQ,SAAS;;;;;;;;;;;;4DAGhC,QAAQ,UAAU,KAAK,yBACtB,6LAAC;gEAAI,WAAU;0EACb,cAAA,6LAAC;oEAAK,WAAU;8EAAsC;;;;;;;;;;;;uDA3CrD,QAAQ,EAAE;;;;;gDAgDlB,0BACC,6LAAC;oDAAI,WAAU;;sEACb,6LAAC;4DAAI,WAAU;sEACb,cAAA,6LAAC;gEAAI,WAAU;;kFACb,6LAAC;wEAAI,WAAU;;;;;;kFACf,6LAAC;wEAAI,WAAU;wEAAkD,OAAO;4EAAE,gBAAgB;wEAAO;;;;;;kFACjG,6LAAC;wEAAI,WAAU;wEAAkD,OAAO;4EAAE,gBAAgB;wEAAO;;;;;;kFACjG,6LAAC;wEAAK,WAAU;kFAA8B,EAAE;;;;;;;;;;;;;;;;;sEAGpD,6LAAC;4DAAI,WAAU;sEACb,cAAA,6LAAC;gEAAK,WAAU;0EAAsC;;;;;;;;;;;;;;;;;gDAI3D,yBACC,6LAAC;oDAAI,WAAU;;sEACb,6LAAC;4DAAI,WAAU;sEACb,cAAA,6LAAC;gEAAK,WAAU;0EAAU;;;;;;;;;;;sEAE5B,6LAAC;4DAAI,WAAU;sEACb,cAAA,6LAAC;gEAAI,WAAU;;kFACb,6LAAC;wEAAI,WAAU;;;;;;kFACf,6LAAC;wEAAI,WAAU;wEAAkD,OAAO;4EAAE,gBAAgB;wEAAO;;;;;;kFACjG,6LAAC;wEAAI,WAAU;wEAAkD,OAAO;4EAAE,gBAAgB;wEAAO;;;;;;;;;;;;;;;;;;;;;;;8DAKzG,6LAAC;oDAAI,KAAK;;;;;;;;;;;;;kDAKhB,6LAAC;wCAAI,WAAU;;4CACZ,uBACC,6LAAC;gDAAI,WAAU;0DACZ;;;;;;0DAGL,6LAAC;gDAAK,UAAU;gDAAc,WAAU;;kEACtC,6LAAC;wDACC,KAAK;wDACL,MAAK;wDACL,OAAO;wDACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;wDACxC,aAAa,EAAE;wDACf,WAAU;wDACV,UAAU;wDACV,SAAS;;;;;;kEAEX,6LAAC;wDACC,MAAK;wDACL,UAAU,CAAC,MAAM,IAAI,MAAM;wDAC3B,WAAU;kEAET,UAAU,EAAE,uBAAuB,EAAE;;;;;;;;;;;;;;;;;;;6DAM9C,6LAAC;gCAAI,WAAU;0CACb,cAAA,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;4CAAI,WAAU;sDAAgB;;;;;;sDAC/B,6LAAC;4CAAG,WAAU;sDAA4C,EAAE;;;;;;sDAC5D,6LAAC;4CAAE,WAAU;sDAAiB,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AASlD;GA5pBwB;;QACL,kJAAO;QACd,4MAAe;;;KAFH"}}]
}