{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/81704/bookyo/apps/dashboard/app/components/LanguageSwitcher.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport type { SupportedLocale } from '../../i18n';\r\n\r\nconst languages: Array<{ code: SupportedLocale; name: string; flag: string }> = [\r\n  { code: 'ja', name: 'Êó•Êú¨Ë™û', flag: 'üáØüáµ' },\r\n  { code: 'en', name: 'English', flag: 'üá∫üá∏' },\r\n  { code: 'zh', name: '‰∏≠Êñá', flag: 'üá®üá≥' },\r\n  { code: 'es', name: 'Espa√±ol', flag: 'üá™üá∏' },\r\n  { code: 'pt-BR', name: 'Portugu√™s', flag: 'üáßüá∑' },\r\n];\r\n\r\nexport function LanguageSwitcher() {\r\n  const [currentLocale, setCurrentLocale] = useState<SupportedLocale>('ja');\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const router = useRouter();\r\n\r\n  useEffect(() => {\r\n    // Get current locale from cookie or localStorage\r\n    const getStoredLocale = (): SupportedLocale => {\r\n      if (typeof window === 'undefined') return 'ja';\r\n      \r\n      const cookies = document.cookie.split(';');\r\n      const langCookie = cookies.find(c => c.trim().startsWith('yoyaku_yo_language='));\r\n      if (langCookie) {\r\n        const value = langCookie.split('=')[1]?.trim() as SupportedLocale;\r\n        if (languages.some(l => l.code === value)) {\r\n          return value;\r\n        }\r\n      }\r\n      \r\n      const stored = localStorage.getItem('yoyaku_yo_language') as SupportedLocale;\r\n      if (languages.some(l => l.code === stored)) {\r\n        return stored;\r\n      }\r\n      \r\n      return 'ja';\r\n    };\r\n\r\n    setCurrentLocale(getStoredLocale());\r\n  }, []);\r\n\r\n  const changeLanguage = (locale: SupportedLocale) => {\r\n    // Save to both cookie and localStorage\r\n    document.cookie = `yoyaku_yo_language=${locale}; path=/; max-age=31536000`; // 1 year\r\n    localStorage.setItem('yoyaku_yo_language', locale);\r\n    \r\n    setCurrentLocale(locale);\r\n    setIsOpen(false);\r\n    \r\n    // Dispatch custom event to notify NextIntlProvider\r\n    window.dispatchEvent(new Event('languageChanged'));\r\n    \r\n    // Refresh the page to apply new locale\r\n    router.refresh();\r\n  };\r\n\r\n  const currentLang = languages.find(l => l.code === currentLocale) || languages[0];\r\n\r\n  return (\r\n    <div className=\"relative\">\r\n      <button\r\n        onClick={() => setIsOpen(!isOpen)}\r\n        className=\"flex items-center gap-2 px-3 py-2 rounded-lg border border-gray-300 bg-white hover:bg-gray-50 transition-colors\"\r\n        aria-label=\"Change language\"\r\n      >\r\n        <span className=\"text-lg\">{currentLang.flag}</span>\r\n        <span className=\"text-sm font-medium text-gray-700\">{currentLang.code.toUpperCase()}</span>\r\n        <svg\r\n          className={`w-4 h-4 text-gray-500 transition-transform ${isOpen ? 'rotate-180' : ''}`}\r\n          fill=\"none\"\r\n          stroke=\"currentColor\"\r\n          viewBox=\"0 0 24 24\"\r\n        >\r\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\r\n        </svg>\r\n      </button>\r\n\r\n      {isOpen && (\r\n        <>\r\n          <div\r\n            className=\"fixed inset-0 z-10\"\r\n            onClick={() => setIsOpen(false)}\r\n          />\r\n          <div className=\"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-20\">\r\n            <div className=\"py-1\">\r\n              {languages.map((lang) => (\r\n                <button\r\n                  key={lang.code}\r\n                  onClick={() => changeLanguage(lang.code)}\r\n                  className={`w-full text-left px-4 py-2 flex items-center gap-3 hover:bg-gray-100 transition-colors ${\r\n                    currentLocale === lang.code ? 'bg-blue-50 text-blue-700' : 'text-gray-700'\r\n                  }`}\r\n                >\r\n                  <span className=\"text-lg\">{lang.flag}</span>\r\n                  <span className=\"text-sm\">{lang.name}</span>\r\n                  {currentLocale === lang.code && (\r\n                    <span className=\"ml-auto text-blue-600\">‚úì</span>\r\n                  )}\r\n                </button>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;;;AAHA;;;AAMA,MAAM,YAA0E;IAC9E;QAAE,MAAM;QAAM,MAAM;QAAO,MAAM;IAAO;IACxC;QAAE,MAAM;QAAM,MAAM;QAAW,MAAM;IAAO;IAC5C;QAAE,MAAM;QAAM,MAAM;QAAM,MAAM;IAAO;IACvC;QAAE,MAAM;QAAM,MAAM;QAAW,MAAM;IAAO;IAC5C;QAAE,MAAM;QAAS,MAAM;QAAa,MAAM;IAAO;CAClD;AAEM,SAAS;;IACd,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAAkB;IACpE,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,yKAAQ,EAAC;IACrC,MAAM,SAAS,IAAA,kJAAS;IAExB,IAAA,0KAAS;sCAAC;YACR,iDAAiD;YACjD,MAAM;8DAAkB;oBACtB;;oBAEA,MAAM,UAAU,SAAS,MAAM,CAAC,KAAK,CAAC;oBACtC,MAAM,aAAa,QAAQ,IAAI;iFAAC,CAAA,IAAK,EAAE,IAAI,GAAG,UAAU,CAAC;;oBACzD,IAAI,YAAY;wBACd,MAAM,QAAQ,WAAW,KAAK,CAAC,IAAI,CAAC,EAAE,EAAE;wBACxC,IAAI,UAAU,IAAI;0EAAC,CAAA,IAAK,EAAE,IAAI,KAAK;0EAAQ;4BACzC,OAAO;wBACT;oBACF;oBAEA,MAAM,SAAS,aAAa,OAAO,CAAC;oBACpC,IAAI,UAAU,IAAI;sEAAC,CAAA,IAAK,EAAE,IAAI,KAAK;sEAAS;wBAC1C,OAAO;oBACT;oBAEA,OAAO;gBACT;;YAEA,iBAAiB;QACnB;qCAAG,EAAE;IAEL,MAAM,iBAAiB,CAAC;QACtB,uCAAuC;QACvC,SAAS,MAAM,GAAG,CAAC,mBAAmB,EAAE,OAAO,0BAA0B,CAAC,EAAE,SAAS;QACrF,aAAa,OAAO,CAAC,sBAAsB;QAE3C,iBAAiB;QACjB,UAAU;QAEV,mDAAmD;QACnD,OAAO,aAAa,CAAC,IAAI,MAAM;QAE/B,uCAAuC;QACvC,OAAO,OAAO;IAChB;IAEA,MAAM,cAAc,UAAU,IAAI,CAAC,CAAA,IAAK,EAAE,IAAI,KAAK,kBAAkB,SAAS,CAAC,EAAE;IAEjF,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBACC,SAAS,IAAM,UAAU,CAAC;gBAC1B,WAAU;gBACV,cAAW;;kCAEX,6LAAC;wBAAK,WAAU;kCAAW,YAAY,IAAI;;;;;;kCAC3C,6LAAC;wBAAK,WAAU;kCAAqC,YAAY,IAAI,CAAC,WAAW;;;;;;kCACjF,6LAAC;wBACC,WAAW,CAAC,2CAA2C,EAAE,SAAS,eAAe,IAAI;wBACrF,MAAK;wBACL,QAAO;wBACP,SAAQ;kCAER,cAAA,6LAAC;4BAAK,eAAc;4BAAQ,gBAAe;4BAAQ,aAAa;4BAAG,GAAE;;;;;;;;;;;;;;;;;YAIxE,wBACC;;kCACE,6LAAC;wBACC,WAAU;wBACV,SAAS,IAAM,UAAU;;;;;;kCAE3B,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC;4BAAI,WAAU;sCACZ,UAAU,GAAG,CAAC,CAAC,qBACd,6LAAC;oCAEC,SAAS,IAAM,eAAe,KAAK,IAAI;oCACvC,WAAW,CAAC,uFAAuF,EACjG,kBAAkB,KAAK,IAAI,GAAG,6BAA6B,iBAC3D;;sDAEF,6LAAC;4CAAK,WAAU;sDAAW,KAAK,IAAI;;;;;;sDACpC,6LAAC;4CAAK,WAAU;sDAAW,KAAK,IAAI;;;;;;wCACnC,kBAAkB,KAAK,IAAI,kBAC1B,6LAAC;4CAAK,WAAU;sDAAwB;;;;;;;mCATrC,KAAK,IAAI;;;;;;;;;;;;;;;;;;;;;;;AAmBhC;GA/FgB;;QAGC,kJAAS;;;KAHV"}},
    {"offset": {"line": 223, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/81704/bookyo/apps/dashboard/lib/shopBrowseData.ts"],"sourcesContent":["// apps/dashboard/lib/shopBrowseData.ts\r\n// Data shaping helpers for browse page - converts flat shop list into nested structures\r\n\r\nexport interface Shop {\r\n  id: string;\r\n  name: string;\r\n  address: string;\r\n  city?: string | null;\r\n  country?: string | null;\r\n  latitude?: number | null;\r\n  longitude?: number | null;\r\n  category_id?: string | null;\r\n  description?: string | null;\r\n  image_url?: string | null;\r\n  categories?: {\r\n    id: string;\r\n    name: string;\r\n    description?: string | null;\r\n  } | null;\r\n  claim_status?: string | null;\r\n}\r\n\r\nexport interface Category {\r\n  id: string;\r\n  name: string;\r\n  description?: string | null;\r\n}\r\n\r\n// Extract prefecture from address or city field\r\nexport function extractPrefecture(shop: Shop): string {\r\n  const address = shop.address || '';\r\n  const city = shop.city || '';\r\n  const combined = `${address} ${city}`.toLowerCase();\r\n\r\n  // Japanese prefecture names\r\n  const prefecturePatterns: Array<{ pattern: RegExp; name: string; key: string }> = [\r\n    { pattern: /Êù±‰∫¨ÈÉΩ|tokyo|Êù±‰∫¨/i, name: 'Êù±‰∫¨ÈÉΩ', key: 'tokyo' },\r\n    { pattern: /Â§ßÈò™Â∫ú|osaka|Â§ßÈò™/i, name: 'Â§ßÈò™Â∫ú', key: 'osaka' },\r\n    { pattern: /‰∫¨ÈÉΩÂ∫ú|kyoto|‰∫¨ÈÉΩ/i, name: '‰∫¨ÈÉΩÂ∫ú', key: 'kyoto' },\r\n    { pattern: /ÂåóÊµ∑ÈÅì|hokkaido|hokkaid≈ç/i, name: 'ÂåóÊµ∑ÈÅì', key: 'hokkaido' },\r\n    { pattern: /ÈùíÊ£ÆÁúå|aomori/i, name: 'ÈùíÊ£ÆÁúå', key: 'aomori' },\r\n    { pattern: /Â≤©ÊâãÁúå|iwate/i, name: 'Â≤©ÊâãÁúå', key: 'iwate' },\r\n    { pattern: /ÂÆÆÂüéÁúå|miyagi/i, name: 'ÂÆÆÂüéÁúå', key: 'miyagi' },\r\n    { pattern: /ÁßãÁî∞Áúå|akita/i, name: 'ÁßãÁî∞Áúå', key: 'akita' },\r\n    { pattern: /Â±±ÂΩ¢Áúå|yamagata/i, name: 'Â±±ÂΩ¢Áúå', key: 'yamagata' },\r\n    { pattern: /Á¶èÂ≥∂Áúå|fukushima/i, name: 'Á¶èÂ≥∂Áúå', key: 'fukushima' },\r\n    { pattern: /Ëå®ÂüéÁúå|ibaraki/i, name: 'Ëå®ÂüéÁúå', key: 'ibaraki' },\r\n    { pattern: /Ê†ÉÊú®Áúå|tochigi/i, name: 'Ê†ÉÊú®Áúå', key: 'tochigi' },\r\n    { pattern: /Áæ§È¶¨Áúå|gunma/i, name: 'Áæ§È¶¨Áúå', key: 'gunma' },\r\n    { pattern: /ÂüºÁéâÁúå|saitama/i, name: 'ÂüºÁéâÁúå', key: 'saitama' },\r\n    { pattern: /ÂçÉËëâÁúå|chiba/i, name: 'ÂçÉËëâÁúå', key: 'chiba' },\r\n    { pattern: /Á•ûÂ•àÂ∑ùÁúå|kanagawa/i, name: 'Á•ûÂ•àÂ∑ùÁúå', key: 'kanagawa' },\r\n    { pattern: /Êñ∞ÊΩüÁúå|niigata/i, name: 'Êñ∞ÊΩüÁúå', key: 'niigata' },\r\n    { pattern: /ÂØåÂ±±Áúå|toyama/i, name: 'ÂØåÂ±±Áúå', key: 'toyama' },\r\n    { pattern: /Áü≥Â∑ùÁúå|ishikawa/i, name: 'Áü≥Â∑ùÁúå', key: 'ishikawa' },\r\n    { pattern: /Á¶è‰∫ïÁúå|fukui/i, name: 'Á¶è‰∫ïÁúå', key: 'fukui' },\r\n    { pattern: /Â±±Ê¢®Áúå|yamanashi/i, name: 'Â±±Ê¢®Áúå', key: 'yamanashi' },\r\n    { pattern: /Èï∑ÈáéÁúå|nagano/i, name: 'Èï∑ÈáéÁúå', key: 'nagano' },\r\n    { pattern: /Â≤êÈòúÁúå|gifu/i, name: 'Â≤êÈòúÁúå', key: 'gifu' },\r\n    { pattern: /ÈùôÂ≤°Áúå|shizuoka/i, name: 'ÈùôÂ≤°Áúå', key: 'shizuoka' },\r\n    { pattern: /ÊÑõÁü•Áúå|aichi/i, name: 'ÊÑõÁü•Áúå', key: 'aichi' },\r\n    { pattern: /‰∏âÈáçÁúå|mie/i, name: '‰∏âÈáçÁúå', key: 'mie' },\r\n    { pattern: /ÊªãË≥ÄÁúå|shiga/i, name: 'ÊªãË≥ÄÁúå', key: 'shiga' },\r\n    { pattern: /ÂÖµÂ∫´Áúå|hyogo|hy≈çgo/i, name: 'ÂÖµÂ∫´Áúå', key: 'hyogo' },\r\n    { pattern: /Â•àËâØÁúå|nara/i, name: 'Â•àËâØÁúå', key: 'nara' },\r\n    { pattern: /ÂíåÊ≠åÂ±±Áúå|wakayama/i, name: 'ÂíåÊ≠åÂ±±Áúå', key: 'wakayama' },\r\n    { pattern: /È≥•ÂèñÁúå|tottori/i, name: 'È≥•ÂèñÁúå', key: 'tottori' },\r\n    { pattern: /Â≥∂Ê†πÁúå|shimane/i, name: 'Â≥∂Ê†πÁúå', key: 'shimane' },\r\n    { pattern: /Â≤°Â±±Áúå|okayama/i, name: 'Â≤°Â±±Áúå', key: 'okayama' },\r\n    { pattern: /Â∫ÉÂ≥∂Áúå|hiroshima/i, name: 'Â∫ÉÂ≥∂Áúå', key: 'hiroshima' },\r\n    { pattern: /Â±±Âè£Áúå|yamaguchi/i, name: 'Â±±Âè£Áúå', key: 'yamaguchi' },\r\n    { pattern: /Âæ≥Â≥∂Áúå|tokushima/i, name: 'Âæ≥Â≥∂Áúå', key: 'tokushima' },\r\n    { pattern: /È¶ôÂ∑ùÁúå|kagawa/i, name: 'È¶ôÂ∑ùÁúå', key: 'kagawa' },\r\n    { pattern: /ÊÑõÂ™õÁúå|ehime/i, name: 'ÊÑõÂ™õÁúå', key: 'ehime' },\r\n    { pattern: /È´òÁü•Áúå|kochi/i, name: 'È´òÁü•Áúå', key: 'kochi' },\r\n    { pattern: /Á¶èÂ≤°Áúå|fukuoka/i, name: 'Á¶èÂ≤°Áúå', key: 'fukuoka' },\r\n    { pattern: /‰ΩêË≥ÄÁúå|saga/i, name: '‰ΩêË≥ÄÁúå', key: 'saga' },\r\n    { pattern: /Èï∑Â¥éÁúå|nagasaki/i, name: 'Èï∑Â¥éÁúå', key: 'nagasaki' },\r\n    { pattern: /ÁÜäÊú¨Áúå|kumamoto/i, name: 'ÁÜäÊú¨Áúå', key: 'kumamoto' },\r\n    { pattern: /Â§ßÂàÜÁúå|oita/i, name: 'Â§ßÂàÜÁúå', key: 'oita' },\r\n    { pattern: /ÂÆÆÂ¥éÁúå|miyazaki/i, name: 'ÂÆÆÂ¥éÁúå', key: 'miyazaki' },\r\n    { pattern: /ÈπøÂÖêÂ≥∂Áúå|kagoshima/i, name: 'ÈπøÂÖêÂ≥∂Áúå', key: 'kagoshima' },\r\n    { pattern: /Ê≤ñÁ∏ÑÁúå|okinawa/i, name: 'Ê≤ñÁ∏ÑÁúå', key: 'okinawa' },\r\n  ];\r\n\r\n  for (const { pattern, name, key } of prefecturePatterns) {\r\n    if (pattern.test(combined)) {\r\n      return key;\r\n    }\r\n  }\r\n\r\n  return 'unknown';\r\n}\r\n\r\n// Extract city/ward from address or use city field\r\nexport function extractCity(shop: Shop): string {\r\n  // Use city field if available\r\n  if (shop.city && shop.city.trim()) {\r\n    return shop.city.trim();\r\n  }\r\n\r\n  // Extract from address\r\n  const address = shop.address || '';\r\n  \r\n  // Try to extract ward/city patterns\r\n  // Pattern: \"XÂå∫\", \"XÂ∏Ç\", \"X-ku\", \"X-shi\", \"X ku\", \"X shi\"\r\n  const patterns = [\r\n    /([^\\s,]+)[Âå∫Â∏ÇÁî∫Êùë]/,\r\n    /([^\\s,]+)[-\\s](ku|shi|city|ward|Âå∫|Â∏Ç|Áî∫|Êùë)/i,\r\n  ];\r\n\r\n  for (const pattern of patterns) {\r\n    const match = address.match(pattern);\r\n    if (match && match[1]) {\r\n      return match[1].trim();\r\n    }\r\n  }\r\n\r\n  // Fallback: try to get first meaningful word from address\r\n  const words = address.split(/[,\\s]+/).filter(w => w.length > 1);\r\n  if (words.length > 0) {\r\n    return words[0];\r\n  }\r\n\r\n  return 'unknown';\r\n}\r\n\r\n// Area tree structure\r\nexport interface AreaTree {\r\n  [prefectureKey: string]: {\r\n    name: string; // Display name (localized later)\r\n    code?: string;\r\n    cities: {\r\n      [cityKey: string]: {\r\n        name: string;\r\n        shopCount: number;\r\n        shops: Shop[];\r\n      };\r\n    };\r\n    shopCount: number;\r\n  };\r\n}\r\n\r\n// Build area tree: Prefecture ‚Üí City ‚Üí Shops\r\nexport function buildAreaTree(shops: Shop[]): AreaTree {\r\n  const tree: AreaTree = {};\r\n\r\n  for (const shop of shops) {\r\n    // Skip hidden shops\r\n    if (shop.claim_status === 'hidden') continue;\r\n\r\n    const prefectureKey = extractPrefecture(shop);\r\n    const cityKey = extractCity(shop);\r\n\r\n    // Initialize prefecture if needed\r\n    if (!tree[prefectureKey]) {\r\n      tree[prefectureKey] = {\r\n        name: prefectureKey, // Will be localized in UI\r\n        cities: {},\r\n        shopCount: 0,\r\n      };\r\n    }\r\n\r\n    // Initialize city if needed\r\n    if (!tree[prefectureKey].cities[cityKey]) {\r\n      tree[prefectureKey].cities[cityKey] = {\r\n        name: cityKey, // Will be localized in UI\r\n        shopCount: 0,\r\n        shops: [],\r\n      };\r\n    }\r\n\r\n    // Add shop\r\n    tree[prefectureKey].cities[cityKey].shops.push(shop);\r\n    tree[prefectureKey].cities[cityKey].shopCount++;\r\n    tree[prefectureKey].shopCount++;\r\n  }\r\n\r\n  return tree;\r\n}\r\n\r\n// Category tree structure\r\nexport interface CategoryTree {\r\n  [categoryId: string]: {\r\n    name: string; // Category name (localized later)\r\n    slug: string;\r\n    shopCount: number;\r\n    prefectures: {\r\n      [prefectureKey: string]: {\r\n        name: string;\r\n        shopCount: number;\r\n        cities: {\r\n          [cityKey: string]: {\r\n            name: string;\r\n            shopCount: number;\r\n            shops: Shop[];\r\n          };\r\n        };\r\n      };\r\n    };\r\n  };\r\n}\r\n\r\n// Build category tree: Category ‚Üí Prefecture ‚Üí City ‚Üí Shops\r\nexport function buildCategoryTree(shops: Shop[], categories: Category[]): CategoryTree {\r\n  const tree: CategoryTree = {};\r\n  const categoryMap = new Map(categories.map(cat => [cat.id, cat]));\r\n\r\n  for (const shop of shops) {\r\n    // Skip hidden shops\r\n    if (shop.claim_status === 'hidden') continue;\r\n\r\n    const categoryId = shop.category_id || 'unknown';\r\n    const category = categoryMap.get(categoryId) || shop.categories;\r\n    const categoryName = category?.name || 'Unknown';\r\n\r\n    const prefectureKey = extractPrefecture(shop);\r\n    const cityKey = extractCity(shop);\r\n\r\n    // Initialize category if needed\r\n    if (!tree[categoryId]) {\r\n      tree[categoryId] = {\r\n        name: categoryName,\r\n        slug: categoryName.toLowerCase().replace(/\\s+/g, '-'),\r\n        shopCount: 0,\r\n        prefectures: {},\r\n      };\r\n    }\r\n\r\n    // Initialize prefecture if needed\r\n    if (!tree[categoryId].prefectures[prefectureKey]) {\r\n      tree[categoryId].prefectures[prefectureKey] = {\r\n        name: prefectureKey, // Will be localized in UI\r\n        shopCount: 0,\r\n        cities: {},\r\n      };\r\n    }\r\n\r\n    // Initialize city if needed\r\n    if (!tree[categoryId].prefectures[prefectureKey].cities[cityKey]) {\r\n      tree[categoryId].prefectures[prefectureKey].cities[cityKey] = {\r\n        name: cityKey, // Will be localized in UI\r\n        shopCount: 0,\r\n        shops: [],\r\n      };\r\n    }\r\n\r\n    // Add shop\r\n    tree[categoryId].prefectures[prefectureKey].cities[cityKey].shops.push(shop);\r\n    tree[categoryId].prefectures[prefectureKey].cities[cityKey].shopCount++;\r\n    tree[categoryId].prefectures[prefectureKey].shopCount++;\r\n    tree[categoryId].shopCount++;\r\n  }\r\n\r\n  return tree;\r\n}\r\n\r\n// Filter shops by search query\r\nexport function filterShopsBySearch(shops: Shop[], searchQuery: string): Shop[] {\r\n  if (!searchQuery.trim()) return shops;\r\n\r\n  const query = searchQuery.toLowerCase().trim();\r\n  \r\n  return shops.filter(shop => {\r\n    // Search in name\r\n    if (shop.name.toLowerCase().includes(query)) return true;\r\n    \r\n    // Search in address\r\n    if (shop.address?.toLowerCase().includes(query)) return true;\r\n    \r\n    // Search in city\r\n    if (shop.city?.toLowerCase().includes(query)) return true;\r\n    \r\n    // Search in category name\r\n    if (shop.categories?.name.toLowerCase().includes(query)) return true;\r\n    \r\n    return false;\r\n  });\r\n}\r\n\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 611, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/81704/bookyo/apps/dashboard/app/browse/page.tsx"],"sourcesContent":["// apps/dashboard/app/browse/page.tsx\r\n// Redesigned browse page with \"By Area\" and \"By Category\" navigation modes\r\n\r\n\"use client\";\r\nimport React, { useState, useEffect, useCallback, useMemo, Suspense } from 'react';\r\nimport Link from 'next/link';\r\nimport { useSearchParams, useRouter } from 'next/navigation';\r\nimport { useTranslations } from 'next-intl';\r\nimport { apiUrl } from '@/lib/apiClient';\r\nimport { LanguageSwitcher } from '@/app/components/LanguageSwitcher';\r\nimport {\r\n  buildAreaTree,\r\n  buildCategoryTree,\r\n  filterShopsBySearch,\r\n  extractPrefecture,\r\n  extractCity,\r\n  type Shop,\r\n  type AreaTree,\r\n  type CategoryTree,\r\n} from '@/lib/shopBrowseData';\r\n\r\ninterface Category {\r\n  id: string;\r\n  name: string;\r\n  description?: string | null;\r\n}\r\n\r\ntype BrowseMode = 'area' | 'category';\r\n\r\nfunction BrowsePageContent() {\r\n  const searchParams = useSearchParams();\r\n  const router = useRouter();\r\n  const t = useTranslations();\r\n  const [shops, setShops] = useState<Shop[]>([]);\r\n  const [categories, setCategories] = useState<Category[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [searchQuery, setSearchQuery] = useState(searchParams.get('search') || '');\r\n  const [browseMode, setBrowseMode] = useState<BrowseMode>(\r\n    (searchParams.get('mode') as BrowseMode) || 'area'\r\n  );\r\n  \r\n  // Navigation state\r\n  const [selectedPrefecture, setSelectedPrefecture] = useState<string | null>(\r\n    searchParams.get('prefecture') || null\r\n  );\r\n  const [selectedCity, setSelectedCity] = useState<string | null>(\r\n    searchParams.get('city') || null\r\n  );\r\n  const [selectedCategoryId, setSelectedCategoryId] = useState<string | null>(\r\n    searchParams.get('category') || null\r\n  );\r\n\r\n  // Debounced search\r\n  const [debouncedSearch, setDebouncedSearch] = useState(searchQuery);\r\n  useEffect(() => {\r\n    const timer = setTimeout(() => {\r\n      setDebouncedSearch(searchQuery);\r\n    }, 500);\r\n    return () => clearTimeout(timer);\r\n  }, [searchQuery]);\r\n\r\n  // Fetch categories\r\n  useEffect(() => {\r\n    const fetchCategories = async () => {\r\n      try {\r\n        const res = await fetch(`${apiUrl}/categories`);\r\n        if (res.ok) {\r\n          const contentType = res.headers.get('content-type');\r\n          if (contentType && contentType.includes('application/json')) {\r\n            const data = await res.json();\r\n            setCategories(Array.isArray(data) ? data : []);\r\n          }\r\n        }\r\n      } catch (error: any) {\r\n        if (!error?.message?.includes('Failed to fetch') && !error?.message?.includes('ERR_CONNECTION_REFUSED')) {\r\n          console.error('Error fetching categories:', error);\r\n        }\r\n        setCategories([]);\r\n      }\r\n    };\r\n    fetchCategories();\r\n  }, [apiUrl]);\r\n\r\n  // Fetch shops\r\n  const fetchShops = useCallback(async () => {\r\n    try {\r\n      setLoading(true);\r\n      const params = new URLSearchParams();\r\n      if (debouncedSearch.trim()) {\r\n        params.set('search', debouncedSearch.trim());\r\n      }\r\n\r\n      const res = await fetch(`${apiUrl}/shops${params.toString() ? `?${params.toString()}` : ''}`);\r\n      if (res.ok) {\r\n        const contentType = res.headers.get('content-type');\r\n        if (contentType && contentType.includes('application/json')) {\r\n          const data = await res.json();\r\n          const shopsArray = Array.isArray(data) ? data : (data.shops || []);\r\n          const visibleShops = shopsArray.filter((shop: Shop) => \r\n            !shop.claim_status || shop.claim_status !== 'hidden'\r\n          );\r\n          setShops(visibleShops);\r\n        }\r\n      }\r\n    } catch (error: any) {\r\n      if (!error?.message?.includes('Failed to fetch') && !error?.message?.includes('ERR_CONNECTION_REFUSED')) {\r\n        console.error('Error fetching shops:', error);\r\n      }\r\n      setShops([]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [apiUrl, debouncedSearch]);\r\n\r\n  useEffect(() => {\r\n    fetchShops();\r\n  }, [fetchShops]);\r\n\r\n  // Update URL when filters change\r\n  useEffect(() => {\r\n    const params = new URLSearchParams();\r\n    if (debouncedSearch) params.set('search', debouncedSearch);\r\n    if (browseMode) params.set('mode', browseMode);\r\n    if (selectedPrefecture) params.set('prefecture', selectedPrefecture);\r\n    if (selectedCity) params.set('city', selectedCity);\r\n    if (selectedCategoryId) params.set('category', selectedCategoryId);\r\n    const newUrl = `/browse${params.toString() ? `?${params.toString()}` : ''}`;\r\n    router.replace(newUrl, { scroll: false });\r\n  }, [debouncedSearch, browseMode, selectedPrefecture, selectedCity, selectedCategoryId, router]);\r\n\r\n  // Build data trees\r\n  const filteredShops = useMemo(() => {\r\n    return filterShopsBySearch(shops, debouncedSearch);\r\n  }, [shops, debouncedSearch]);\r\n\r\n  const areaTree = useMemo(() => {\r\n    return buildAreaTree(filteredShops);\r\n  }, [filteredShops]);\r\n\r\n  const categoryTree = useMemo(() => {\r\n    return buildCategoryTree(filteredShops, categories);\r\n  }, [filteredShops, categories]);\r\n\r\n  // Get translated prefecture name\r\n  const getPrefectureName = (key: string): string => {\r\n    try {\r\n      const translated = t(`prefectures.${key}`);\r\n      return translated !== `prefectures.${key}` ? translated : key;\r\n    } catch {\r\n      return key;\r\n    }\r\n  };\r\n\r\n  // Get translated city name\r\n  const getCityName = (key: string): string => {\r\n    try {\r\n      const translated = t(`cities.${key}`);\r\n      return translated !== `cities.${key}` ? translated : key;\r\n    } catch {\r\n      return key;\r\n    }\r\n  };\r\n\r\n  // Get translated category name\r\n  const getCategoryName = (categoryName: string): string => {\r\n    const key = categoryName.toLowerCase().replace(/\\s+/g, '_');\r\n    try {\r\n      const translated = t(`categories.${key}`);\r\n      return translated !== `categories.${key}` ? translated : categoryName;\r\n    } catch {\r\n      return categoryName;\r\n    }\r\n  };\r\n\r\n  // Get shops to display based on current selection\r\n  const displayShops = useMemo(() => {\r\n    let shops: Shop[] = [];\r\n    \r\n    if (browseMode === 'area') {\r\n      if (selectedCity && selectedPrefecture) {\r\n        shops = areaTree[selectedPrefecture]?.cities[selectedCity]?.shops || [];\r\n      } else if (selectedPrefecture) {\r\n        // Return all shops in prefecture\r\n        const prefecture = areaTree[selectedPrefecture];\r\n        if (prefecture) {\r\n          shops = Object.values(prefecture.cities).flatMap(city => city.shops);\r\n        }\r\n      }\r\n    } else {\r\n      // Category mode\r\n      if (selectedCity && selectedPrefecture && selectedCategoryId) {\r\n        shops = categoryTree[selectedCategoryId]?.prefectures[selectedPrefecture]?.cities[selectedCity]?.shops || [];\r\n      } else if (selectedPrefecture && selectedCategoryId) {\r\n        const category = categoryTree[selectedCategoryId];\r\n        if (category) {\r\n          const prefecture = category.prefectures[selectedPrefecture];\r\n          if (prefecture) {\r\n            shops = Object.values(prefecture.cities).flatMap(city => city.shops);\r\n          }\r\n        }\r\n      } else if (selectedCategoryId) {\r\n        const category = categoryTree[selectedCategoryId];\r\n        if (category) {\r\n          shops = Object.values(category.prefectures).flatMap(pref => \r\n            Object.values(pref.cities).flatMap(city => city.shops)\r\n          );\r\n        }\r\n      }\r\n    }\r\n    \r\n    // Deduplicate shops by ID to prevent duplicate key errors\r\n    const seen = new Set<string>();\r\n    return shops.filter(shop => {\r\n      if (seen.has(shop.id)) {\r\n        return false;\r\n      }\r\n      seen.add(shop.id);\r\n      return true;\r\n    });\r\n  }, [browseMode, selectedPrefecture, selectedCity, selectedCategoryId, areaTree, categoryTree]);\r\n\r\n  // Reset navigation when mode changes\r\n  const handleModeChange = (mode: BrowseMode) => {\r\n    setBrowseMode(mode);\r\n    setSelectedPrefecture(null);\r\n    setSelectedCity(null);\r\n    setSelectedCategoryId(null);\r\n  };\r\n\r\n  // Sort prefectures by name\r\n  const sortedPrefectures = useMemo(() => {\r\n    const prefs = Object.keys(browseMode === 'area' ? areaTree : \r\n      (selectedCategoryId && categoryTree[selectedCategoryId] ? categoryTree[selectedCategoryId].prefectures : {}));\r\n    return prefs.sort((a, b) => {\r\n      const nameA = getPrefectureName(a);\r\n      const nameB = getPrefectureName(b);\r\n      return nameA.localeCompare(nameB, 'ja');\r\n    });\r\n  }, [browseMode, areaTree, categoryTree, selectedCategoryId, getPrefectureName]);\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50\">\r\n      {/* Header */}\r\n      <div className=\"bg-white border-b border-gray-200 sticky top-0 z-20\">\r\n        <div className=\"max-w-7xl mx-auto px-4 py-4\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <h1 className=\"text-2xl font-bold text-gray-900\">\r\n              {t('shops.shops')}\r\n            </h1>\r\n            <LanguageSwitcher />\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"max-w-7xl mx-auto px-4 py-6\">\r\n        {/* Search Bar */}\r\n        <div className=\"mb-6\">\r\n          <input\r\n            type=\"text\"\r\n            value={searchQuery}\r\n            onChange={(e) => setSearchQuery(e.target.value)}\r\n            placeholder={t('shops.searchPlaceholder')}\r\n            className=\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none\"\r\n          />\r\n        </div>\r\n\r\n        {/* Tabs */}\r\n        <div className=\"mb-6 border-b border-gray-200\">\r\n          <div className=\"flex gap-4\">\r\n            <button\r\n              onClick={() => handleModeChange('area')}\r\n              className={`px-4 py-2 font-medium border-b-2 transition-colors ${\r\n                browseMode === 'area'\r\n                  ? 'border-blue-600 text-blue-600'\r\n                  : 'border-transparent text-gray-600 hover:text-gray-900'\r\n              }`}\r\n            >\r\n              {t('browse.byArea')}\r\n            </button>\r\n            <button\r\n              onClick={() => handleModeChange('category')}\r\n              className={`px-4 py-2 font-medium border-b-2 transition-colors ${\r\n                browseMode === 'category'\r\n                  ? 'border-blue-600 text-blue-600'\r\n                  : 'border-transparent text-gray-600 hover:text-gray-900'\r\n              }`}\r\n            >\r\n              {t('browse.byCategory')}\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {loading ? (\r\n          <div className=\"text-center py-12\">\r\n            <div className=\"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\r\n            <p className=\"mt-4 text-gray-600\">{t('shops.loading')}</p>\r\n          </div>\r\n        ) : (\r\n          <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-6\">\r\n            {/* Left Sidebar - Navigation */}\r\n            <aside className=\"lg:col-span-1\">\r\n              <div className=\"bg-white rounded-xl border border-gray-200 p-4 sticky top-24\">\r\n                {browseMode === 'area' ? (\r\n                  <AreaNavigation\r\n                    areaTree={areaTree}\r\n                    selectedPrefecture={selectedPrefecture}\r\n                    selectedCity={selectedCity}\r\n                    onSelectPrefecture={setSelectedPrefecture}\r\n                    onSelectCity={setSelectedCity}\r\n                    getPrefectureName={getPrefectureName}\r\n                    getCityName={getCityName}\r\n                    t={t}\r\n                  />\r\n                ) : (\r\n                  <CategoryNavigation\r\n                    categoryTree={categoryTree}\r\n                    categories={categories}\r\n                    selectedCategoryId={selectedCategoryId}\r\n                    selectedPrefecture={selectedPrefecture}\r\n                    selectedCity={selectedCity}\r\n                    onSelectCategory={setSelectedCategoryId}\r\n                    onSelectPrefecture={setSelectedPrefecture}\r\n                    onSelectCity={setSelectedCity}\r\n                    getCategoryName={getCategoryName}\r\n                    getPrefectureName={getPrefectureName}\r\n                    getCityName={getCityName}\r\n                    t={t}\r\n                  />\r\n                )}\r\n              </div>\r\n            </aside>\r\n\r\n            {/* Main Content - Shop List */}\r\n            <div className=\"lg:col-span-3\">\r\n              {displayShops.length === 0 ? (\r\n                <div className=\"bg-white rounded-xl border border-gray-200 p-12 text-center\">\r\n                  <div className=\"text-6xl mb-4\">üè™</div>\r\n                  <h2 className=\"text-2xl font-bold text-gray-900 mb-2\">{t('shops.noShops')}</h2>\r\n                  <p className=\"text-gray-600\">{t('shops.tryAdjusting')}</p>\r\n                </div>\r\n              ) : (\r\n                <>\r\n                  <div className=\"mb-4 text-sm text-gray-600\">\r\n                    {t('shops.shopsFound', { count: displayShops.length })}\r\n                  </div>\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n                    {displayShops.map((shop) => (\r\n                      <ShopCard key={shop.id} shop={shop} getCategoryName={getCategoryName} t={t} />\r\n                    ))}\r\n                  </div>\r\n                </>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Area Navigation Component\r\nfunction AreaNavigation({\r\n  areaTree,\r\n  selectedPrefecture,\r\n  selectedCity,\r\n  onSelectPrefecture,\r\n  onSelectCity,\r\n  getPrefectureName,\r\n  getCityName,\r\n  t,\r\n}: {\r\n  areaTree: AreaTree;\r\n  selectedPrefecture: string | null;\r\n  selectedCity: string | null;\r\n  onSelectPrefecture: (pref: string | null) => void;\r\n  onSelectCity: (city: string | null) => void;\r\n  getPrefectureName: (key: string) => string;\r\n  getCityName: (key: string) => string;\r\n  t: any;\r\n}) {\r\n  const sortedPrefectures = Object.keys(areaTree).sort((a, b) => {\r\n    const nameA = getPrefectureName(a);\r\n    const nameB = getPrefectureName(b);\r\n    return nameA.localeCompare(nameB, 'ja');\r\n  });\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <h3 className=\"font-semibold text-gray-900\">{t('browse.prefecture')}</h3>\r\n      <div className=\"space-y-2 max-h-96 overflow-y-auto\">\r\n        {sortedPrefectures.map((prefKey) => {\r\n          const prefecture = areaTree[prefKey];\r\n          const isSelected = selectedPrefecture === prefKey;\r\n          return (\r\n            <div key={prefKey}>\r\n              <button\r\n                onClick={() => {\r\n                  onSelectPrefecture(isSelected ? null : prefKey);\r\n                  onSelectCity(null);\r\n                }}\r\n                className={`w-full text-left px-3 py-2 rounded-lg transition-colors ${\r\n                  isSelected\r\n                    ? 'bg-blue-100 text-blue-700 font-medium'\r\n                    : 'text-gray-700 hover:bg-gray-100'\r\n                }`}\r\n              >\r\n                <div className=\"flex items-center justify-between\">\r\n                  <span>{getPrefectureName(prefKey)}</span>\r\n                  <span className=\"text-xs text-gray-500\">({prefecture.shopCount})</span>\r\n                </div>\r\n              </button>\r\n              {isSelected && (\r\n                <div className=\"mt-2 ml-4 space-y-1\">\r\n                  {Object.keys(prefecture.cities)\r\n                    .sort((a, b) => {\r\n                      const nameA = getCityName(a);\r\n                      const nameB = getCityName(b);\r\n                      return nameA.localeCompare(nameB, 'ja');\r\n                    })\r\n                    .map((cityKey) => {\r\n                      const city = prefecture.cities[cityKey];\r\n                      const isCitySelected = selectedCity === cityKey;\r\n                      return (\r\n                        <button\r\n                          key={cityKey}\r\n                          onClick={() => onSelectCity(isCitySelected ? null : cityKey)}\r\n                          className={`w-full text-left px-3 py-1.5 rounded text-sm transition-colors ${\r\n                            isCitySelected\r\n                              ? 'bg-blue-50 text-blue-600 font-medium'\r\n                              : 'text-gray-600 hover:bg-gray-50'\r\n                          }`}\r\n                        >\r\n                          <div className=\"flex items-center justify-between\">\r\n                            <span>{getCityName(cityKey)}</span>\r\n                            <span className=\"text-xs text-gray-500\">({city.shopCount})</span>\r\n                          </div>\r\n                        </button>\r\n                      );\r\n                    })}\r\n                </div>\r\n              )}\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Category Navigation Component\r\nfunction CategoryNavigation({\r\n  categoryTree,\r\n  categories,\r\n  selectedCategoryId,\r\n  selectedPrefecture,\r\n  selectedCity,\r\n  onSelectCategory,\r\n  onSelectPrefecture,\r\n  onSelectCity,\r\n  getCategoryName,\r\n  getPrefectureName,\r\n  getCityName,\r\n  t,\r\n}: {\r\n  categoryTree: CategoryTree;\r\n  categories: Category[];\r\n  selectedCategoryId: string | null;\r\n  selectedPrefecture: string | null;\r\n  selectedCity: string | null;\r\n  onSelectCategory: (id: string | null) => void;\r\n  onSelectPrefecture: (pref: string | null) => void;\r\n  onSelectCity: (city: string | null) => void;\r\n  getCategoryName: (name: string) => string;\r\n  getPrefectureName: (key: string) => string;\r\n  getCityName: (key: string) => string;\r\n  t: any;\r\n}) {\r\n  const sortedCategories = categories\r\n    .filter(cat => categoryTree[cat.id])\r\n    .sort((a, b) => {\r\n      const nameA = getCategoryName(a.name);\r\n      const nameB = getCategoryName(b.name);\r\n      return nameA.localeCompare(nameB);\r\n    });\r\n\r\n  const selectedCategory = selectedCategoryId ? categoryTree[selectedCategoryId] : null;\r\n  const selectedPrefectureData = selectedCategory && selectedPrefecture\r\n    ? selectedCategory.prefectures[selectedPrefecture]\r\n    : null;\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <h3 className=\"font-semibold text-gray-900\">{t('browse.category')}</h3>\r\n      <div className=\"space-y-2 max-h-96 overflow-y-auto\">\r\n        {sortedCategories.map((category) => {\r\n          const categoryData = categoryTree[category.id];\r\n          const isSelected = selectedCategoryId === category.id;\r\n          return (\r\n            <div key={category.id}>\r\n              <button\r\n                onClick={() => {\r\n                  onSelectCategory(isSelected ? null : category.id);\r\n                  onSelectPrefecture(null);\r\n                  onSelectCity(null);\r\n                }}\r\n                className={`w-full text-left px-3 py-2 rounded-lg transition-colors ${\r\n                  isSelected\r\n                    ? 'bg-blue-100 text-blue-700 font-medium'\r\n                    : 'text-gray-700 hover:bg-gray-100'\r\n                }`}\r\n              >\r\n                <div className=\"flex items-center justify-between\">\r\n                  <span>{getCategoryName(category.name)}</span>\r\n                  <span className=\"text-xs text-gray-500\">({categoryData.shopCount})</span>\r\n                </div>\r\n              </button>\r\n              {isSelected && selectedCategory && (\r\n                <>\r\n                  {selectedPrefecture ? (\r\n                    <div className=\"mt-2 ml-4 space-y-1\">\r\n                      {selectedPrefectureData && Object.keys(selectedPrefectureData.cities)\r\n                        .sort((a, b) => {\r\n                          const nameA = getCityName(a);\r\n                          const nameB = getCityName(b);\r\n                          return nameA.localeCompare(nameB, 'ja');\r\n                        })\r\n                        .map((cityKey) => {\r\n                          const city = selectedPrefectureData.cities[cityKey];\r\n                          const isCitySelected = selectedCity === cityKey;\r\n                          return (\r\n                            <button\r\n                              key={cityKey}\r\n                              onClick={() => onSelectCity(isCitySelected ? null : cityKey)}\r\n                              className={`w-full text-left px-3 py-1.5 rounded text-sm transition-colors ${\r\n                                isCitySelected\r\n                                  ? 'bg-blue-50 text-blue-600 font-medium'\r\n                                  : 'text-gray-600 hover:bg-gray-50'\r\n                              }`}\r\n                            >\r\n                              <div className=\"flex items-center justify-between\">\r\n                                <span>{getCityName(cityKey)}</span>\r\n                                <span className=\"text-xs text-gray-500\">({city.shopCount})</span>\r\n                              </div>\r\n                            </button>\r\n                          );\r\n                        })}\r\n                    </div>\r\n                  ) : (\r\n                    <div className=\"mt-2 ml-4 space-y-1\">\r\n                      {Object.keys(selectedCategory.prefectures)\r\n                        .sort((a, b) => {\r\n                          const nameA = getPrefectureName(a);\r\n                          const nameB = getPrefectureName(b);\r\n                          return nameA.localeCompare(nameB, 'ja');\r\n                        })\r\n                        .map((prefKey) => {\r\n                          const prefecture = selectedCategory.prefectures[prefKey];\r\n                          const isPrefSelected = selectedPrefecture === prefKey;\r\n                          return (\r\n                            <button\r\n                              key={prefKey}\r\n                              onClick={() => {\r\n                                onSelectPrefecture(isPrefSelected ? null : prefKey);\r\n                                onSelectCity(null);\r\n                              }}\r\n                              className={`w-full text-left px-3 py-1.5 rounded text-sm transition-colors ${\r\n                                isPrefSelected\r\n                                  ? 'bg-blue-50 text-blue-600 font-medium'\r\n                                  : 'text-gray-600 hover:bg-gray-50'\r\n                              }`}\r\n                            >\r\n                              <div className=\"flex items-center justify-between\">\r\n                                <span>{getPrefectureName(prefKey)}</span>\r\n                                <span className=\"text-xs text-gray-500\">({prefecture.shopCount})</span>\r\n                              </div>\r\n                            </button>\r\n                          );\r\n                        })}\r\n                    </div>\r\n                  )}\r\n                </>\r\n              )}\r\n            </div>\r\n          );\r\n        })}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Shop Card Component\r\nfunction ShopCard({ shop, getCategoryName, t }: { shop: Shop; getCategoryName: (name: string) => string; t: any }) {\r\n  return (\r\n    <Link\r\n      href={`/shops/${shop.id}`}\r\n      className=\"bg-white rounded-xl border border-gray-200 overflow-hidden hover:shadow-lg transition-shadow\"\r\n    >\r\n      {shop.image_url && (\r\n        <div className=\"w-full h-48 overflow-hidden bg-gray-100\">\r\n          <img\r\n            src={shop.image_url}\r\n            alt={shop.name}\r\n            className=\"w-full h-full object-cover\"\r\n          />\r\n        </div>\r\n      )}\r\n      <div className=\"p-6\">\r\n        <div className=\"mb-2\">\r\n          <h3 className=\"text-xl font-bold text-gray-900 mb-1\">{shop.name}</h3>\r\n          {shop.categories && (\r\n            <span className=\"inline-block px-2 py-1 bg-blue-100 text-blue-700 text-xs font-medium rounded\">\r\n              {getCategoryName(shop.categories.name)}\r\n            </span>\r\n          )}\r\n        </div>\r\n        {shop.description && (\r\n          <p className=\"text-gray-600 text-sm mb-3 line-clamp-2\">\r\n            {shop.description.length > 100 ? shop.description.substring(0, 100) + '...' : shop.description}\r\n          </p>\r\n        )}\r\n        <p className=\"text-gray-500 text-sm mb-4\">{shop.address}</p>\r\n        <div className=\"mt-4\">\r\n          <span className=\"inline-block px-3 py-1 bg-blue-600 text-white text-sm font-medium rounded-lg\">\r\n            {t('shops.viewDetails')} ‚Üí\r\n          </span>\r\n        </div>\r\n      </div>\r\n    </Link>\r\n  );\r\n}\r\n\r\nexport default function BrowsePage() {\r\n  return (\r\n    <Suspense fallback={\r\n      <div className=\"flex items-center justify-center min-h-[400px]\">\r\n        <div className=\"text-center\">\r\n          <div className=\"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\r\n          <p className=\"mt-4 text-gray-600\">Loading...</p>\r\n        </div>\r\n      </div>\r\n    }>\r\n      <BrowsePageContent />\r\n    </Suspense>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}